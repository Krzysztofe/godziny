"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[311],{9662:function(e,n,r){r.d(n,{j0:function(){return s},nt:function(){return d},st:function(){return c},vs:function(){return l},xk:function(){return u}});var t=new Date,a=function(e){var n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(t)},o=new Date(t.getTime()+12096e5),i=new Date(t.getTime()+5184e6),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),d=(String(t.getDate()).padStart(2,"0"),a(t),a(o)),c=a(i),u=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t)},1100:function(e,n,r){var t=r(1830),a=r.n(t),o=r(2791),i=r(4849),s=r(184);n.Z=function(e,n){(0,o.useEffect)((function(){if(e.isError){var n=e.error,r=n&&"status"in n&&n.status&&n.status;a().fire({title:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[e.isError]);var r=n;return e.isLoading&&(r=(0,s.jsx)(i.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},9065:function(e,n,r){var t=r(7689);n.Z=function(){var e=(0,t.TH)().pathname.split("/").slice(-1)[0],n=null===e||void 0===e?void 0:e.slice(0,4),r=null===e||void 0===e?void 0:e.slice(-2);return{monthURL:e,yearFromURL:n,monthFromURL:r}}},6311:function(e,n,r){r.r(n),r.d(n,{default:function(){return X}});var t=r(4849),a=r(9662),o=r(9065),i=r(3166),s=r(1413),l=r(9439),d=r(2791),c=r(793),u=r(7022),m=r(9743),x=r(4165),f=r(5861),v=r(3360),h=r(1830),p=r.n(h),y=r(1100),g=r(6856),b=r(1578),j=r(6021),Z=r(184),H=function(e){var n,r;(0,j.xY)().data;if(null!==e&&void 0!==e&&null!==(n=e.day)&&void 0!==n&&n.date){var t,a,o=new Date(e.day.date);return r=new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(o),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"d-flex justify-content-between fs-7",children:[(0,Z.jsx)("div",{children:null===(t=e.day)||void 0===t?void 0:t.userName}),(0,Z.jsx)("div",{children:"Poza"===(null===(a=e.day)||void 0===a?void 0:a.place)?(0,Z.jsx)(b.ols,{style:{color:"rgb(80,173,150)"}}):(0,Z.jsx)(g.P8U,{style:{color:"rgb(255, 181, 9)"}})})]}),(0,Z.jsx)("div",{className:"d-flex fw-medium justify-content-between",children:(0,Z.jsx)("div",{children:r||""})})]})}return(0,Z.jsx)("div",{children:"Brak danych"})},N=r(3853),w=r(7425),k=r(6700),L=function(e){var n,r=(0,o.Z)(),t=r.yearFromURL,a=r.monthFromURL,d=(0,i.a6)({year:t,month:a}).data,u=(0,i.ur)(),m=(0,l.Z)(u,2),h=m[0],g=m[1],b=(0,y.Z)(g,(0,Z.jsx)(w.GnT,{className:"text-danger"})).btnContent,j=function(){var n=(0,f.Z)((0,x.Z)().mark((function n(r,o){return(0,x.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:p().fire((0,k.p)("Chcesz usuni\u0105\u0107 dzie\u0144")).then(function(){var n=(0,f.Z)((0,x.Z)().mark((function n(i){var s,l,c;return(0,x.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!i.isConfirmed){n.next=4;break}return c=null===d||void 0===d||null===(s=d.columns[r])||void 0===s||null===(l=s.days)||void 0===l?void 0:l.filter((function(e){return(null===e||void 0===e?void 0:e.id)!==o})),n.next=4,h({year:t,month:a,colIdx:e.columnIdx,daysBody:c||[]});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}();return(0,Z.jsx)(c._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id),index:e.dayIdx,isDragDisabled:!1,children:function(n,r){var t,a;return(0,Z.jsx)("div",(0,s.Z)((0,s.Z)((0,s.Z)({},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,className:"border rounded-1 ".concat(r.isDragging?"border-dark":"border-0"),children:(0,Z.jsxs)("div",{className:"mb-2 px-1 py-2 py-sm-1 rounded-1",style:{backgroundColor:null===(t=e.day)||void 0===t?void 0:t.userColor},children:[(0,Z.jsx)(H,{day:e.day}),(0,Z.jsxs)(v.Z,{onClick:function(){return j(e.columnIdx,e.day.id)},className:"d-flex justify-content-between  align-items-center w-100 p-0 bg-transparent border-0",disabled:g.isLoading,children:[(0,Z.jsxs)("div",{className:"d-flex align-items-center fs-7",children:[null===(a=e.day)||void 0===a?void 0:a.hours," ",(0,Z.jsx)(N.TCC,{className:"  ms-1"})]}),(0,Z.jsx)("div",{className:"d-flex align-items-center",children:b})]})]})}))}})},z=r(2677),S=function(e){return(0,Z.jsx)(z.Z,{className:"p-0",children:(0,Z.jsx)(c.bK,{droppableId:e.column.id,children:function(n,r){return(0,Z.jsxs)("div",(0,s.Z)((0,s.Z)({},n.droppableProps),{},{ref:n.innerRef,className:"p-1 h-100 ".concat(r.isDraggingOver?"bg-dark-subtle":"bg-primary"),children:[Array.isArray(e.column.days)?e.column.days.map((function(n,r){return(0,Z.jsx)(L,{day:n,columnIdx:e.columnIdx,dayIdx:r},crypto.randomUUID())})):[],n.placeholder]}))}})})},F=function(e){var n=(0,o.Z)(),r=n.yearFromURL,t=n.monthFromURL,a=(0,i.I8)({year:r,month:t}).data;return(0,Z.jsx)(Z.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===a||void 0===a?void 0:a.submittedHours},{headerText:"Przyznane:",counter:null===a||void 0===a?void 0:a.acceptedHours},{headerText:"Odrzucone:",counter:null===a||void 0===a?void 0:a.rejectedHours}].map((function(n){var r=n.headerText,t=n.counter;return(0,Z.jsxs)(z.Z,{className:"bg-primary text-dark-emphasis fw-medium p-1 ".concat(0===e.thumbPosition?"":" border-bottom border-1 border-dark-subtle"),style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[r," ","",t]},r)}))})},I=r(3433),R=function(e){return Array.isArray(e)?null===e||void 0===e?void 0:e.map((function(e){return null!==e&&void 0!==e&&e.hasOwnProperty("days")?e:(0,s.Z)((0,s.Z)({},e),{},{days:[]})})):[]},U=r(7762),C=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.a6)({year:n,month:r}).data,a=0,s=0,l=0;if(null!==t&&void 0!==t&&t.id){var d,c=R(null===t||void 0===t?void 0:t.columns),u=(0,U.Z)(c);try{for(u.s();!(d=u.n()).done;){var m=d.value,x=(m.days||[]).reduce((function(e,n){var r;return e+(null!==(r=null===n||void 0===n?void 0:n.hours)&&void 0!==r?r:0)}),0);switch(m.id){case"submitted":a=x;break;case"accepted":s=x;break;case"rejected":l=x}}}catch(f){u.e(f)}finally{u.f()}return{submittedHoursSum:a,acceptedHoursSum:s,rejectedHoursSum:l}}return{submittedHoursSum:0,acceptedHoursSum:0,rejectedHoursSum:0}},D=function(){var e=(0,d.useRef)(null),n=(0,d.useState)(0),r=(0,l.Z)(n,2),t=r[0],a=r[1];return{scrollableRef:e,thumbPosition:t,handleScroll:function(){var n=e.current;if(n){var r=n.scrollTop,t=n.scrollHeight,o=n.clientHeight;a(r/(t-o)*100)}}}},B=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.a6)({year:n,month:r}).data,a=(0,i.X)(),x=(0,l.Z)(a,1)[0],f=(0,i.ej)(),v=(0,l.Z)(f,1)[0],h=C(),p=h.submittedHoursSum,y=h.acceptedHoursSum,g=h.rejectedHoursSum,b=D(),j=b.scrollableRef,H=b.thumbPosition,N=b.handleScroll,w=null!==t&&void 0!==t&&t.columns?R(t.columns):[],k=(0,d.useState)([]),L=(0,l.Z)(k,2),z=L[0],U=L[1],B=(0,d.useState)(null),T=(0,l.Z)(B,2),P=T[0],E=T[1];(0,d.useEffect)((function(){U(w)}),[t]),(0,d.useEffect)((function(){null!==P&&x({year:n,month:r,columnsBody:z})}),[P]),(0,d.useEffect)((function(){var e,a;null!==t&&void 0!==t&&t.id&&v({year:n,month:r,calcBody:(0,s.Z)((0,s.Z)({},null===t||void 0===t?void 0:t.calc),{},{currentHours:(null!==(e=null===t||void 0===t||null===(a=t.calc)||void 0===a?void 0:a.allHours)&&void 0!==e?e:0)-p-y-g+g,submittedHours:p,acceptedHours:y,rejectedHours:g})})}),[t]);return(0,Z.jsx)(u.Z,{fluid:!0,ref:j,onScroll:N,className:" mb-1 overflow-y-scroll",children:(0,Z.jsxs)("div",{className:"",children:[(0,Z.jsx)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1 sticky-top",children:(0,Z.jsx)(F,{thumbPosition:H})}),(0,Z.jsx)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1",style:{height:"fit-content"},children:(0,Z.jsx)(c.Z5,{onDragEnd:function(e){!function(e,n,r){var t=e.source,a=e.destination;if(a&&(t.draggableId!==a.droppableId||t.index===a.index))if(t.droppableId!==a.droppableId){var o=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===t.droppableId})),i=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===a.droppableId})),d=n&&(0,I.Z)(n[o].days),c=t.droppableId!==a.dropableId?(0,I.Z)(n[i].days):d,u=d.splice(t.index,1),m=(0,l.Z)(u,1)[0];c.splice(a.index,0,m);var x=(0,I.Z)(n);x[o]=(0,s.Z)((0,s.Z)({},n[o]),{},{days:d}),x[i]=(0,s.Z)((0,s.Z)({},n[i]),{},{days:c}),r(x)}else{var f=a.index,v=n.findIndex((function(e){return e.id===t.droppableId})),h=(0,I.Z)(n[v].days),p=h.splice(t.index,1),y=(0,l.Z)(p,1)[0];h.splice(f,0,y);var g=(0,I.Z)(n);g[v]=(0,s.Z)((0,s.Z)({},n[v]),{},{days:h}),r(g)}}(e,z,U),E(e)},children:null===z||void 0===z?void 0:z.map((function(e,n){return(0,Z.jsx)(S,{column:e,columnIdx:n},e.id)}))})})]})})},T=r(7858),P=r(3855),E=r(5705),A=r(8007),O=A.Ry({allHours:A.Rx().max(320,"Max. 320").required("Podaj liczb\u0119 godzin")}),M=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.I8)({year:n,month:r}).data,a=(0,i.uZ)(),s=(0,l.Z)(a,2),d=s[0],c=s[1],u=0,m=0;null!==t&&void 0!==t&&t.submittedHours&&t.acceptedHours&&(u=null===t||void 0===t?void 0:t.submittedHours,m=null===t||void 0===t?void 0:t.acceptedHours);var v=(0,E.TA)({initialValues:{allHours:0},validationSchema:O,onSubmit:function(){var e=(0,f.Z)((0,x.Z)().mark((function e(t){return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u+m>+v.values.allHours)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d({year:n,month:r,allHours:+t.allHours});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()});return{formik:v,success:c}},Y=function(){var e=M(),n=e.formik,r=e.success,t=(0,o.Z)(),a=t.yearFromURL,s=t.monthFromURL,l=(0,i.I8)({year:a,month:s}).data,d=(0,y.Z)(r,"Zapisz liczb\u0119 godzin").btnContent,c=0,u=0;null!==l&&void 0!==l&&l.submittedHours&&l.acceptedHours&&(c=null===l||void 0===l?void 0:l.submittedHours,u=null===l||void 0===l?void 0:l.acceptedHours);var m=n.values.allHours/3.2,x="linear-gradient(to right, rgba(180,120,255) ".concat(m,"%, rgba(180,180,255) ").concat(m,"%)");return(0,Z.jsxs)(P.Z,{onSubmit:n.handleSubmit,className:"p-2 bg-primary rounded-bottom-1",children:[(0,Z.jsx)(P.Z.Control,{type:"number",name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,placeholder:"Liczba",size:"sm",className:"p-0 px-1 mx-auto mb-2 border border-primary",style:{minHeight:0,cursor:"pointer",width:"fit-content"}}),(0,Z.jsx)("div",{className:"text-danger d-block mt-0 fs-8 text-center",style:{height:"0.7rem"},children:c+u>+n.values.allHours?"Podaj ilo\u015b\u0107 godzin wi\u0119ksz\u0105 od ".concat(c+u," "):""}),(0,Z.jsxs)(P.Z.Group,{className:"mt-2 d-flex align-items-center w-100",children:[(0,Z.jsx)("div",{className:"fw-medium",children:"0"}),(0,Z.jsx)(P.Z.Range,{name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,className:"form-range custom-range mx-2 medium",style:{height:10,background:x}}),(0,Z.jsx)("div",{className:"fw-medium",children:"320"})]}),(0,Z.jsx)(v.Z,{type:"submit",variant:"info",size:"sm",className:"fw-medium d-block mx-auto mt-2 col-7 col-sm-6 col-md-4 col-lg-3 col-xxl-2",disabled:r.isLoading,children:d})]})},G=function(){var e=(0,d.useState)(!1),n=(0,l.Z)(e,2),r=n[0],t=n[1];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(v.Z,{onClick:function(){return t(!r)},"aria-controls":"example-collapse-text","aria-expanded":r,className:"fw-medium w-100 mt-1 d-flex justify-content-center align-items-center bg-primary border-0 p-0 ".concat(r?"rounded-bottom-0":""),children:["Liczba godzin w miesi\u0105cu",(0,Z.jsx)(g.x3N,{className:"fs-2 fw-medium",style:{transform:"".concat(r?"rotate(180deg)":""," "),transitionDuration:"320ms"}})]}),(0,Z.jsx)(T.Z,{in:r,children:(0,Z.jsx)("div",{className:"bg-white p-0",children:(0,Z.jsx)(Y,{})})})]})},q=r(7689),K=function(){var e=(0,q.UO)().monthURL,n=e&&new Date(e);return{monthURLStringFormat:n&&new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(n)}},V=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.I8)({year:n,month:r}).data,a=K().monthURLStringFormat,s=0;return null!==t&&void 0!==t&&t.currentHours&&(s=null===t||void 0===t?void 0:t.currentHours),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"text-capitalize fw-medium mt-2 text-center d-md-none",children:a}),(0,Z.jsxs)("div",{className:" d-flex justify-content-center my-2 fw-medium position-relative",children:[(0,Z.jsx)("div",{className:"text-capitalize fw-medium d-none d-md-block  position-absolute end-0",children:a}),(0,Z.jsx)("div",{className:"col-3 text-end",children:"Wszystkie"}),(0,Z.jsxs)("div",{className:"mx-2",children:[null===t||void 0===t?void 0:t.allHours," -"," ",(0,Z.jsx)("span",{className:"".concat(s<0?"text-danger":""),children:null===t||void 0===t?void 0:t.currentHours})]}),(0,Z.jsx)("div",{className:"col-3 ".concat(s<0?"text-danger":""),children:s<0?"Brak":"Dost\u0119pne"})]})]})},W=function(){return(0,Z.jsx)("header",{className:"me-3",children:(0,Z.jsx)(u.Z,{fluid:!0,children:(0,Z.jsxs)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 ms-sm-auto mx-xl-auto px-1 ",children:[(0,Z.jsx)(G,{}),(0,Z.jsx)(V,{})]})})})},X=function(){var e,n=(0,o.Z)(),r=n.yearFromURL,s=n.monthFromURL,l=(0,i.S$)(void 0),d=l.data,c=l.error,u=l.isLoading,m=(0,i.a6)({year:r,month:s}).data,x="d-flex flex-column bg-primary-subtle";if(!u&&!c&&d&&m||(x="d-flex justify-content-center align-items-center"),u)e=(0,Z.jsx)(t.Z,{animation:"border",variant:"secondary",children:(0,Z.jsx)("span",{className:"visually-hidden",children:"Loading..."})});else if(c){if("status"in c){var f="status"in c&&c.status;return(0,Z.jsx)("h3",{className:"text-danger col-5",children:(0,Z.jsxs)(Z.Fragment,{children:[" B\u0142\u0105d: ",f," "]})})}}else e=d?m?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(W,{}),(0,Z.jsx)(B,{})]}):(0,Z.jsxs)("h3",{className:"text-warning text-center col-5",children:["Brak danych z miesi\u0105ca ",a.xk,". Dodaj miesi\u0105c za pomoc\u0105 formularza"]}):(0,Z.jsx)("h5",{className:"text-warning text-center col-5",children:"Brak miesi\u0119cy zapisanych w bazie danych. Dodaj miesi\u0105c za pomoc\u0105 formularza"});return(0,Z.jsx)("main",{className:x,style:{height:"100vh"},children:e})}},6700:function(e,n,r){r.d(n,{p:function(){return t}});var t=function(e){return{title:e,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}}}}]);
//# sourceMappingURL=311.eb701aab.chunk.js.map