"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[263],{3786:function(n,e,r){var t=r(1419),o=r(184);e.Z=function(n){var e=(0,t.Z)().windowWidth;return(0,o.jsxs)("main",{className:"d-flex backgroundImage m-0 opacityAnimation",style:{height:"100dvh",overflow:"hidden"},children:[(0,o.jsx)("aside",{style:{width:e>=500?"30%":0,maxWidth:"250px",height:"100%"}}),(0,o.jsx)("div",{className:"d-flex ps-1 flex-fill",style:{width:e>=500?"70%":"100%"},children:n.children})]})}},1100:function(n,e,r){var t=r(1830),o=r.n(t),i=r(2791),d=r(4849),a=r(184);e.Z=function(n,e){(0,i.useEffect)((function(){if(n.isError){var e=n.error,r=e&&"status"in e&&e.status&&e.status;o().fire({text:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[n.isError]);var r=e;return n.isLoading&&(r=(0,a.jsx)(d.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},3234:function(n,e,r){var t=r(7689);e.Z=function(){var n=(0,t.TH)().pathname.slice(1);if(n&&/^\d{4}-\d{2}$/.test(n)){var e,r=n&&new Date(n);return{monthURLStringFormat:r&&(null===(e=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}))||void 0===e?void 0:e.format(r))}}return{monthURLStringFormat:""}}},9065:function(n,e,r){var t=r(7689);e.Z=function(){var n=(0,t.TH)().pathname.split("/").slice(-1)[0],e=null===n||void 0===n?void 0:n.slice(0,4),r=null===n||void 0===n?void 0:n.slice(-2);return{monthURL:n,yearFromURL:e,monthFromURL:r,isMonthInURL:/^\d{4}-\d{2}$/.test(n)}}},1419:function(n,e,r){var t=r(9439),o=r(2791);e.Z=function(){var n=(0,o.useState)(window.innerWidth),e=(0,t.Z)(n,2),r=e[0],i=e[1];return(0,o.useEffect)((function(){var n=function(){i(window.innerWidth)};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[]),{windowWidth:r}}},1263:function(n,e,r){r.r(e),r.d(e,{default:function(){return O}});var t=r(4849),o=r(5048),i=r(3234),d=r(3940),a=r(184),s=function(){var n,e,r,t,i=(0,o.v9)((function(n){return n.monthPanel})).month;return(0,a.jsxs)("div",{className:"d-flex gap-2 mx-auto fw-medium pb-2 w-fit-content",children:[(0,a.jsxs)("div",{children:["Wszystkie ",null===i||void 0===i||null===(n=i.calcHours)||void 0===n?void 0:n.allHours," - "]}),(0,a.jsxs)("div",{className:"".concat(i&&(null===i||void 0===i||null===(e=i.calcHours)||void 0===e?void 0:e.currentHours)<=0?"text-danger":""),children:[i&&(null===i||void 0===i||null===(r=i.calcHours)||void 0===r?void 0:r.currentHours)," ","",i&&(null===i||void 0===i||null===(t=i.calcHours)||void 0===t?void 0:t.currentHours)<0?"Brak":"Dost\u0119pne"]})]})},u=r(1413),l=r(9439),c=r(2791),v=r(793),m=r(9065),f=r(7615),h=r(2677),x=r(4165),p=r(5861),y=r(3360),b=r(7425),Z=r(1830),j=r.n(Z),g=r(1100),H=r(2767),w=r(6856),I=r(1578),N=function(n){var e,r;if(null!==n&&void 0!==n&&null!==(e=n.day)&&void 0!==e&&e.date){var t,o,i=new Date(n.day.date);return r=new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(i),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between fs-7 ",children:[(0,a.jsx)("div",{children:null===(t=n.day)||void 0===t?void 0:t.userName}),(0,a.jsx)("div",{children:"Poza"===(null===(o=n.day)||void 0===o?void 0:o.place)?(0,a.jsx)(I.ols,{style:{color:"rgb(80,173,150)"}}):(0,a.jsx)(w.P8U,{style:{color:"rgb(255, 181, 9)"}})})]}),(0,a.jsx)("div",{className:"d-flex fw-medium justify-content-between",children:(0,a.jsx)("div",{children:r||""})})]})}return(0,a.jsx)("div",{children:"Brak danych"})},k=function(n,e){var r=n.columns.map((function(n){var r,t=null===n||void 0===n||null===(r=n.days)||void 0===r?void 0:r.filter((function(n){return n.id!==e}));return(0,u.Z)((0,u.Z)({},n),{},{days:t})}));return(0,u.Z)((0,u.Z)({},n),{},{columns:r})},L=function(n,e,r){if(!n||!n.calcHours)return{currentHours:0,submittedHours:0,acceptedHours:0,rejectedHours:0,allHours:0};var t=n.calcHours;return(0,u.Z)((0,u.Z)({},t),{},{currentHours:2!==e&&r?t.currentHours+r:t.currentHours,submittedHours:0===e&&r?t.submittedHours-r:t.submittedHours,acceptedHours:1===e&&r?t.acceptedHours-r:t.acceptedHours,rejectedHours:2===e&&r?t.rejectedHours-r:t.rejectedHours})},P=function(n){var e,r=(0,m.Z)(),t=r.yearFromURL,i=r.monthFromURL,d=(0,o.v9)((function(n){return n.monthPanel})).month,s=(0,f.ur)(),c=(0,l.Z)(s,2),h=c[0],Z=c[1],w=(0,g.Z)(Z,(0,a.jsx)(b.GnT,{className:"text-danger"})).btnContent,I=function(){var e=(0,p.Z)((0,x.Z)().mark((function e(r,o){return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j().fire((0,H.p)("Usun\u0105\u0107 dzie\u0144")).then(function(){var e=(0,p.Z)((0,x.Z)().mark((function e(a){var s,l;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isConfirmed){e.next=6;break}if(l=null===(s=(0,u.Z)({},null===d||void 0===d?void 0:d.columns[n.columnIdx].days.find((function(e){return(null===e||void 0===e?void 0:e.id)===n.day.id}))))||void 0===s?void 0:s.hours,e.t0=d,!e.t0){e.next=6;break}return e.next=6,h({year:t,month:i,colIdx:n.columnIdx,monthBody:(0,u.Z)((0,u.Z)({},d),{},{calcHours:L(d,r,l),columns:k((0,u.Z)({},d),o).columns})});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return(0,a.jsx)(v._l,{draggableId:n.day&&(null===n||void 0===n||null===(e=n.day)||void 0===e?void 0:e.id),index:n.dayIdx,isDragDisabled:!1,children:function(e,r){var t,o;return(0,a.jsx)("div",(0,u.Z)((0,u.Z)((0,u.Z)({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef,className:"mb-2 bg-white rounded border ".concat(r.isDragging?"border-dark":"border-dark-subtle"," "),children:(0,a.jsxs)("div",{className:"px-1 py-2 py-sm-1 rounded",style:{borderTop:"8px solid ".concat(null===(t=n.day)||void 0===t?void 0:t.userColor),opacity:r.isDragging?.8:1},children:[(0,a.jsx)(N,{day:n.day}),(0,a.jsxs)(y.Z,{onClick:function(){return I(n.columnIdx,n.day.id)},className:"d-flex justify-content-between  align-items-center w-100 p-0 bg-transparent border-0 fw-medium text-dark",disabled:Z.isLoading,children:[(0,a.jsxs)("div",{children:[null===(o=n.day)||void 0===o?void 0:o.hours," h"]}),(0,a.jsx)("div",{children:w})]})]})}))}})},B=r(4261),F=function(n){return(0,a.jsx)(h.Z,{children:(0,a.jsx)(v.bK,{droppableId:n.column.id,children:function(e,r){return(0,a.jsxs)("div",(0,u.Z)((0,u.Z)({},e.droppableProps),{},{ref:e.innerRef,className:"p-1 h-100 overflow-hidden border border-1 border border-top-0",style:{backgroundColor:r.isDraggingOver?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.2)",height:"100%"},children:[Array.isArray(n.column.days)?n.column.days.map((function(e,r){return(0,a.jsx)(P,{day:e,columnIdx:n.columnIdx,dayIdx:r},(0,B.Z)())})):[],e.placeholder]}))}})})},R=function(n){var e,r,t,i=(0,o.v9)((function(n){return n.monthPanel})).month;return(0,a.jsx)(a.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===i||void 0===i||null===(e=i.calcHours)||void 0===e?void 0:e.submittedHours},{headerText:"Przyznane:",counter:null===i||void 0===i||null===(r=i.calcHours)||void 0===r?void 0:r.acceptedHours},{headerText:"Odrzucone:",counter:null===i||void 0===i||null===(t=i.calcHours)||void 0===t?void 0:t.rejectedHours}].map((function(e){var r=e.headerText,t=e.counter;return(0,a.jsxs)(h.Z,{className:"text-dark-emphasis bg-white fw-medium p-1 ".concat(0===n.thumbPosition?"border-bottom border-3 border-white":"border-bottom border-3"),style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[r," ","",t]},r)}))})},C=function(){var n=(0,c.useRef)(null),e=(0,c.useState)(0),r=(0,l.Z)(e,2),t=r[0],o=r[1];return{scrollableRef:n,thumbPosition:t,handleScroll:function(){var e=n.current;if(e){var r=e.scrollTop,t=e.scrollHeight,i=e.clientHeight;o(r/(t-i)*100)}}}},T=r(3433),z=r(1419),U=function(n){return null===n||void 0===n?void 0:n.reduce((function(n,e){return n+((null===e||void 0===e?void 0:e.hours)||0)}),0)},S=function(n){var e,r,t;return{submittedHours:U(null===(e=n[0])||void 0===e?void 0:e.days),acceptedHours:U(null===(r=n[1])||void 0===r?void 0:r.days),rejectedHours:U(null===(t=n[2])||void 0===t?void 0:t.days)}},D=function(){var n=(0,m.Z)(),e=n.yearFromURL,r=n.monthFromURL,t=(0,f.CB)(),i=(0,l.Z)(t,1)[0],d=(0,o.v9)((function(n){return n.monthPanel})).month,s=d&&function(n){return Array.isArray(n)?null===n||void 0===n?void 0:n.map((function(n){return null!==n&&void 0!==n&&n.hasOwnProperty("days")?n:(0,u.Z)((0,u.Z)({},n),{},{days:[]})})):[]}(null===d||void 0===d?void 0:d.columns),h=(0,c.useState)([]),x=(0,l.Z)(h,2),p=x[0],y=x[1],b=(0,c.useState)(!1),Z=(0,l.Z)(b,2),j=Z[0],g=Z[1],H=S(p),w=H.submittedHours,I=H.acceptedHours,N=H.rejectedHours,k=C(),L=k.scrollableRef,P=k.thumbPosition,B=k.handleScroll,U=(0,z.Z)().windowWidth;(0,c.useEffect)((function(){s&&y(s)}),[null===d||void 0===d?void 0:d.columns]),(0,c.useEffect)((function(){var n;p.length>0&&d&&i({year:e,month:r,monthBody:(0,u.Z)((0,u.Z)({},d),{},{columns:p,calcHours:(0,u.Z)((0,u.Z)({},null===d||void 0===d?void 0:d.calcHours),{},{currentHours:(null===d||void 0===d||null===(n=d.calcHours)||void 0===n?void 0:n.allHours)-w-I-N+N,submittedHours:w,acceptedHours:I,rejectedHours:N})})})}),[j]);var D="d-flex column-gap-1";return(0,a.jsxs)("div",{ref:L,onScroll:B,className:"p-0 overflow-y-scroll h-100",style:{maxHeight:U>=500?"calc(100% - 32px)":"calc(100% - 32px - 2.5rem)"},children:[(0,a.jsx)("div",{className:"".concat(D," sticky-top"),children:(0,a.jsx)(R,{thumbPosition:P})}),(0,a.jsx)("div",{className:"".concat(D),style:{minHeight:"calc(100% - 35px)"},children:(0,a.jsx)(v.Z5,{onDragEnd:function(n){d&&function(n,e,r,t){var o,i,d=n.source,a=n.destination;if(a&&(d.draggableId!==a.droppableId||d.index===a.index)){var s=null===(o=r[2])||void 0===o||null===(i=o.days[d.index])||void 0===i?void 0:i.hours;if(!("rejected"===d.droppableId&&e<s))if(d.droppableId!==a.droppableId){var c=null===r||void 0===r?void 0:r.findIndex((function(n){return n.id===d.droppableId})),v=null===r||void 0===r?void 0:r.findIndex((function(n){return n.id===a.droppableId})),m=r&&(0,T.Z)(r[c].days),f=d.droppableId!==a.dropableId?(0,T.Z)(r[v].days):m,h=m.splice(d.index,1),x=(0,l.Z)(h,1)[0];f.splice(a.index,0,x);var p=(0,T.Z)(r);p[c]=(0,u.Z)((0,u.Z)({},r[c]),{},{days:m}),p[v]=(0,u.Z)((0,u.Z)({},r[v]),{},{days:f}),t(p)}else{var y=a.index,b=r.findIndex((function(n){return n.id===d.droppableId})),Z=(0,T.Z)(r[b].days),j=Z.splice(d.index,1),g=(0,l.Z)(j,1)[0];Z.splice(y,0,g);var H=(0,T.Z)(r);H[b]=(0,u.Z)((0,u.Z)({},r[b]),{},{days:Z}),t(H)}}}(n,null===d||void 0===d?void 0:d.calcHours.currentHours,p,y),g((function(n){return!n}))},children:null===p||void 0===p?void 0:p.map((function(n,e){return(0,a.jsx)(F,{column:n,columnIdx:e},n.id)}))})})]})},E=function(){return(0,a.jsxs)("div",{className:"py-1",style:{maxWidth:"1000px",width:"100%"},children:[(0,a.jsx)(s,{}),(0,a.jsx)(D,{})]})},W=function(){var n,e=(0,o.v9)((function(n){return n.monthPanel})),r=e.month,s=e.error,u=e.isLoading,l=(0,i.Z)().monthURLStringFormat;if(u)n=(0,d.a)((0,a.jsx)(t.Z,{animation:"border",variant:"secondary",className:"fs-6",children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}));else if(s){if("status"in s){var c="status"in s&&s.status;n=(0,d.a)((0,a.jsxs)("div",{className:"text-danger text-center ",children:[(0,a.jsxs)(a.Fragment,{children:[" B\u0142\u0105d: ",c," "]})," ",(0,a.jsx)("br",{}),(0,a.jsx)(a.Fragment,{children:"Od\u015bwie\u017c stron\u0119"})]}))}}else n=r&&""!==(null===r||void 0===r?void 0:r.id)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E,{})}):(0,d.a)((0,a.jsxs)("div",{children:["Brak danych z miesi\u0105ca ",l,". Zapisz miesi\u0105c w ustawieniach."]}));return{requestState:n}},A=r(3786),O=function(){var n=W().requestState;return(0,a.jsx)(A.Z,{children:n})}},2767:function(n,e,r){r.d(e,{Z:function(){return d},p:function(){return i}});var t=r(1830),o=r.n(t),i=function(n){return{title:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}},d=function(n){o().fire({text:"B\u0142\u0105d ".concat(n),confirmButtonColor:"rgb(31, 180, 255)"})}},3940:function(n,e,r){r.d(e,{a:function(){return o}});var t=r(184),o=function(n){return(0,t.jsx)("div",{className:" d-flex justify-content-center align-items-center fs-3 text-warning text-center",style:{maxWidth:"1000px",width:"100%",height:"100%"},children:n})}}}]);
//# sourceMappingURL=263.3a9f1438.chunk.js.map