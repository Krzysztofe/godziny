"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[654],{9662:function(e,n,r){r.d(n,{j0:function(){return s},kc:function(){return d},p1:function(){return u},vs:function(){return l},xk:function(){return c}});var t=new Date,a=function(e){var n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(t)},o=new Date(t.getTime()+12096e5),i=new Date(t.getTime()+5184e6),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),d=(String(t.getDate()).padStart(2,"0"),a(t),a(o)),u=a(i),c=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t)},1100:function(e,n,r){var t=r(1830),a=r.n(t),o=r(2791),i=r(4849),s=r(184);n.Z=function(e,n){(0,o.useEffect)((function(){if(e.isError){var n=e.error,r=n&&"status"in n&&n.status&&n.status;a().fire({title:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[e.isError]);var r=n;return e.isLoading&&(r=(0,s.jsx)(i.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},4654:function(e,n,r){r.r(n),r.d(n,{default:function(){return Y}});var t=r(4849),a=r(1413),o=r(9439),i=r(2791),s=r(793),l=r(7022),d=r(7689),u=function(){var e=(0,d.UO)().monthURL,n=null===e||void 0===e?void 0:e.slice(0,4),r=null===e||void 0===e?void 0:e.slice(-2);return{monthURL:e,yearFromURL:n,monthFromURL:r}},c=r(322),m=r(4165),v=r(5861),h=r(3360),f=r(1830),x=r.n(f),y=r(1100),p=r(6856),g=r(1578),j=r(3853),b=r(184),Z=function(e){var n,r,t,a,o=new Date(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.date),i=o&&new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(o);return(0,b.jsxs)("div",{className:"px-1 py-2 py-sm-1",children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between",style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[(0,b.jsx)("div",{children:null===(r=e.day)||void 0===r?void 0:r.userName}),(0,b.jsxs)("div",{children:[null===(t=e.day)||void 0===t?void 0:t.hours," ",(0,b.jsx)(j.TCC,{className:"text-primary"})]})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)("div",{children:i||""}),(0,b.jsx)("div",{children:"Poza"===(null===(a=e.day)||void 0===a?void 0:a.place)?(0,b.jsx)(g.ols,{className:"text-success"}):(0,b.jsx)(p.P8U,{className:"text-danger"})})]})]})},H=function(e){var n,r=u(),t=r.yearFromURL,i=r.monthFromURL,l=(0,c.a6)({year:t,month:i}).data,d=(0,c.ur)(),f=(0,o.Z)(d,2),p=f[0],g=f[1],j=(0,y.Z)(g,"Usu\u0144").btnContent,H=function(){var n=(0,v.Z)((0,m.Z)().mark((function n(r,a){return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:x().fire({title:"Chcesz usun\u0105\u0107 dzie\u0144?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}).then(function(){var n=(0,v.Z)((0,m.Z)().mark((function n(o){var s,d,u;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o.isConfirmed){n.next=4;break}return u=null===l||void 0===l||null===(s=l.columns[r])||void 0===s||null===(d=s.days)||void 0===d?void 0:d.filter((function(e){return e.id!==a})),n.next=4,p({year:t,month:i,colIdx:e.columnIdx,daysBody:u});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}();return(0,b.jsx)(s._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id),index:e.dayIdx,isDragDisabled:!1,children:function(n){return(0,b.jsxs)("div",(0,a.Z)((0,a.Z)((0,a.Z)({className:"bg-white card mb-2"},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[(0,b.jsx)(Z,{day:e.day}),(0,b.jsx)(h.Z,{variant:"info",size:"sm",className:"rounded-top-0 w-100 fw-medium ",onClick:function(){return H(e.columnIdx,e.day.id)},disabled:g.isLoading,children:j})]}))}})},w=function(e){return(0,b.jsx)("div",{className:"w-100",children:(0,b.jsx)(s.bK,{droppableId:e.column.id,children:function(n,r){return(0,b.jsxs)("div",(0,a.Z)((0,a.Z)({},n.droppableProps),{},{ref:n.innerRef,className:"p-1 bg-primary-subtle h-100",children:[Array.isArray(e.column.days)?e.column.days.map((function(n,r){return(0,b.jsx)(H,{day:n,columnIdx:e.columnIdx,dayIdx:r},crypto.randomUUID())})):[],n.placeholder]}))}})})},N=function(){var e=u(),n=e.yearFromURL,r=e.monthFromURL,t=(0,c.I8)({year:n,month:r}).data;return(0,b.jsx)(b.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===t||void 0===t?void 0:t.submittedHours},{headerText:"Przyznane:",counter:null===t||void 0===t?void 0:t.acceptedHours},{headerText:"Odrzucone:",counter:null===t||void 0===t?void 0:t.rejectedHours}].map((function(e){var n=e.headerText,r=e.counter;return(0,b.jsxs)("div",{className:"p-1 bg-primary-subtle text-dark-emphasis fw-medium w-100 border-4 border-bottom border-white",style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[n," ","",r]},n)}))})},L=r(3433),S=function(e){return Array.isArray(e)?null===e||void 0===e?void 0:e.map((function(e){return null!==e&&void 0!==e&&e.hasOwnProperty("days")?e:(0,a.Z)((0,a.Z)({},e),{},{days:[]})})):[]},U=function(){var e,n,r,t,a,o,i=u(),s=i.yearFromURL,l=i.monthFromURL,d=(0,c.a6)({year:s,month:l}).data,m=S(null===d||void 0===d?void 0:d.columns);return console.log("ff",m),{submittedHoursSum:d&&m&&(null===(e=m[0])||void 0===e||null===(n=e.days)||void 0===n?void 0:n.reduce((function(e,n){return e+(null===n?0:null===n||void 0===n?void 0:n.hours)}),0)),acceptedHoursSum:d&&m&&(null===(r=m[1])||void 0===r||null===(t=r.days)||void 0===t?void 0:t.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0)),rejectedHoursSum:d&&m&&(null===(a=m[2])||void 0===a||null===(o=a.days)||void 0===o?void 0:o.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0))}},z=function(){var e=u(),n=e.yearFromURL,r=e.monthFromURL,t=(0,c.a6)({year:n,month:r}).data,d=(0,c.X)(),m=(0,o.Z)(d,1)[0],v=(0,c.ej)(),h=(0,o.Z)(v,1)[0],f=S(null===t||void 0===t?void 0:t.columns),x=U(),y=x.submittedHoursSum,p=x.acceptedHoursSum,g=x.rejectedHoursSum,j=(0,i.useState)([]),Z=(0,o.Z)(j,2),H=Z[0],z=Z[1],R=(0,i.useState)(null),F=(0,o.Z)(R,2),I=F[0],k=F[1];(0,i.useEffect)((function(){z(f)}),[t]),(0,i.useEffect)((function(){null!==I&&m({year:n,month:r,columnsBody:H})}),[I]),(0,i.useEffect)((function(){var e;h({year:n,month:r,allHours:(0,a.Z)((0,a.Z)({},null===t||void 0===t?void 0:t.calc),{},{currentHours:(null===t||void 0===t||null===(e=t.calc)||void 0===e?void 0:e.allHours)-y-p-g+g,submittedHours:y,acceptedHours:p,rejectedHours:g})})}),[t]);var C=(0,i.useRef)(null),D=(0,i.useState)(0),B=(0,o.Z)(D,2),T=B[0],P=B[1];return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("main",{ref:C,onScroll:function(){var e=C.current;if(e){var n=e.scrollTop,r=e.scrollHeight,t=e.clientHeight;P(n/(r-t)*100)}},className:"mb-2 overflow-y-scroll ",style:{top:"".concat(T,"%")},children:[(0,b.jsx)(l.Z,{className:"mx-0 ms-sm-auto sticky-top d-flex column-gap-2",children:(0,b.jsx)(N,{})}),(0,b.jsx)(l.Z,{className:"mx-0 ms-sm-auto mb-5 d-flex column-gap-2",style:{height:"fit-content"},children:(0,b.jsx)(s.Z5,{onDragEnd:function(e){!function(e,n,r){var t=e.source,i=e.destination;if(i&&(t.draggableId!==i.droppableId||t.index===i.index))if(t.droppableId!==i.droppableId){var s,l=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===t.droppableId})),d=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===i.droppableId})),u=n&&(0,L.Z)(null===(s=n[l])||void 0===s?void 0:s.days),c=t.droppableId!==i.dropableId?(0,L.Z)(n[d].days):u,m=u.splice(t.index,1),v=(0,o.Z)(m,1)[0];c.splice(i.index,0,v);var h=(0,L.Z)(n);h[l]=(0,a.Z)((0,a.Z)({},n[l]),{},{days:u}),h[d]=(0,a.Z)((0,a.Z)({},n[d]),{},{days:c}),r(h)}else{var f=i.index,x=n.findIndex((function(e){return e.id===t.droppableId})),y=(0,L.Z)(n[x].days),p=y.splice(t.index,1),g=(0,o.Z)(p,1)[0];y.splice(f,0,g);var j=(0,L.Z)(n);j[x]=(0,a.Z)((0,a.Z)({},n[x]),{},{days:y}),r(j)}}(e,H,z),k(e)},children:null===H||void 0===H?void 0:H.map((function(e,n){return(0,b.jsx)(w,{column:e,columnIdx:n},e.id)}))})})]})})},R=r(7858),F=r(3027),I=function(){var e,n,r,t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=(0,c.S$)(void 0),s=i.data,l=i.error,d=i.isLoading,u=s&&Object.keys(s),m=u&&Object.values(s).flat().map((function(e,n){return(0,a.Z)((0,a.Z)({},e),{},{id:u[n]})})),v=(t=m,Array.isArray(t)?null===t||void 0===t?void 0:t.map((function(e){var n,r;return(null===e||void 0===e||null===(n=e.columns)||void 0===n?void 0:n.every((function(e){return e.hasOwnProperty("days")})))?e:(0,a.Z)((0,a.Z)({},e),{},{columns:null===e||void 0===e||null===(r=e.columns)||void 0===r?void 0:r.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{days:e.days||[]})}))})})):[]),h=s&&v.length>0?null===v||void 0===v?void 0:v.find((function(e){return e.monthDate===o})):void 0,f=s&&(null===h||void 0===h?void 0:h.columns),x=s?null===h||void 0===h?void 0:h.allHours:"",y=s?null===h||void 0===h?void 0:h.currentHours:"",p=s?null===h||void 0===h?void 0:h.submitedHours:"",g=s?null===h||void 0===h?void 0:h.acceptedHours:"",j=s?null===h||void 0===h?void 0:h.rejectedHours:"",b=s&&v.length>0&&null!==f&&void 0!==f&&f[0].days?null===f||void 0===f||null===(e=f[0])||void 0===e?void 0:e.days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):0,Z=s&&v.length>0&&null!==f&&void 0!==f&&f[0].days?null===f||void 0===f||null===(n=f[1])||void 0===n?void 0:n.days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):0,H=s&&v.length>0&&null!==f&&void 0!==f&&f[0].days?null===f||void 0===f||null===(r=f[2])||void 0===r?void 0:r.days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):0,w=s&&v?v.map((function(e){return e.monthDate})):[],N=s?w.sort((function(e,n){return e<n?-1:e>n?1:0})):[];return{data:s,error:l,isLoading:d,databaseMonthsId:u,databaseMonthsCollection:v,databaseMonth:h,databaseColumns:f,databaseAllHours:x,dataCurrentHours:y,databaseAcceptedHours:g,databaseRejectedHours:j,dataBaseSubmitedHours:p,acceptedHoursSum:Z,rejectedHoursSum:H,submitedHoursSum:b,databaseMonthsDates:w,databaseMonthsDatesSorted:N}},k=r(5705),C=r(8007),D=C.Ry({allHours:C.Rx().max(320,"Max. 320").required("Podaj liczb\u0119 godzin")}),B=function(){var e=u(),n=(e.monthURL,e.yearFromURL),r=e.monthFromURL,t=(0,c.uZ)(),a=(0,o.Z)(t,2),i=a[0],s=a[1],l=(0,k.TA)({initialValues:{allHours:0},validationSchema:D,onSubmit:function(){var e=(0,v.Z)((0,m.Z)().mark((function e(t){return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("",t.allHours),e.next=3,i({year:n,month:r,allHours:+t.allHours});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()});return{formik:l,success:s}},T=function(){var e=(0,d.UO)().monthURL,n=B().formik,r=I(e),t=r.dataBaseSubmitedHours,a=r.databaseAcceptedHours;return(0,b.jsxs)(F.Z,{onSubmit:n.handleSubmit,className:"my-2",children:[(0,b.jsx)(F.Z.Control,{type:"number",name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,placeholder:"Liczba",size:"sm",className:"p-0 px-1 mx-auto mb-2 border border-primary",style:{minHeight:0,cursor:"pointer",width:"fit-content"}}),(0,b.jsx)("div",{className:"text-danger d-block mt-0 fs-8 text-center",style:{height:"0.7rem"},children:t+a>+n.values.allHours?"Podaj ilo\u015b\u0107 godzin wi\u0119ksz\u0105 od ".concat(t+a," "):""}),(0,b.jsxs)(F.Z.Group,{className:"mt-2 d-flex align-items-center w-100",children:[(0,b.jsx)("div",{className:"fw-medium",children:"0"}),(0,b.jsx)(F.Z.Range,{name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,className:"form-range custom-range mx-2 medium",style:{height:10,background:"linear-gradient(to right, olive 0%, red ".concat(n.values.allHours,"%, transparent ").concat(n.values.allHours,"%, transparent 100%)")}}),(0,b.jsx)("div",{className:"fw-medium",children:"320"})]}),(0,b.jsx)(h.Z,{type:"submit",variant:"info",size:"sm",className:"fw-medium d-block mx-auto mt-2 col-sm-4 col-md-3 col-lg-2",children:" yo"})]})},P=function(){var e=(0,i.useState)(!1),n=(0,o.Z)(e,2),r=n[0],t=n[1];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(h.Z,{onClick:function(){return t(!r)},"aria-controls":"example-collapse-text","aria-expanded":r,variant:"info",className:"fw-medium p-1 w-100 mt-1 d-flex justify-content-center align-items-center",children:["Liczba godzin w miesi\u0105cu",(0,b.jsx)(p.x3N,{className:"fs-1 fw-medium",style:{transform:"".concat(r?"rotate(180deg)":""," "),transitionDuration:"320ms"}})]}),(0,b.jsx)(R.Z,{in:r,children:(0,b.jsx)("div",{className:"bg-primary-subtle rounded p-1",children:(0,b.jsx)(T,{})})})]})},A=function(){var e=(0,d.UO)().monthURL,n=e&&new Date(e);return{monthURLStringFormat:n&&new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(n)}},M=function(){var e=u(),n=e.monthURL,r=e.yearFromURL,t=e.monthFromURL,a=I(n),o=(a.databaseAllHours,a.dataCurrentHours),i=A().monthURLStringFormat,s=(0,c.I8)({year:r,month:t}).data;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-capitalize fw-medium mt-2 text-center d-sm-none",children:i}),(0,b.jsxs)("div",{className:" d-flex justify-content-center my-2 fw-medium position-relative",children:[(0,b.jsx)("div",{className:"text-capitalize fw-medium d-none d-sm-block  position-absolute end-0",children:i}),(0,b.jsx)("div",{className:"col-3 text-end",children:"Wszystkie"}),(0,b.jsxs)("div",{className:"mx-2",children:[null===s||void 0===s?void 0:s.allHours," -"," ",(0,b.jsx)("span",{className:"".concat(o<0?"text-danger":""),children:null===s||void 0===s?void 0:s.currentHours})]}),(0,b.jsx)("div",{className:"col-3 ".concat(o<0?"text-danger":""),children:o<0?"Brak":"Dost\u0119pne"})]})]})},O=function(){return(0,b.jsx)("header",{className:"me-3",children:(0,b.jsxs)(l.Z,{className:"mx-0 ms-sm-auto ",children:[(0,b.jsx)(P,{}),(0,b.jsx)(M,{})]})})},E=r(9662),Y=function(){var e,n=u(),r=n.yearFromURL,a=n.monthFromURL,o=(0,c.S$)(void 0),i=o.data,s=o.error,l=o.isLoading,d=(0,c.a6)({year:r,month:a}).data;if(l)e=(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh"},children:(0,b.jsx)(t.Z,{animation:"border",variant:"secondary",children:(0,b.jsx)("span",{className:"visually-hidden",children:"Loading..."})})});else if(s){if("status"in s){var m="status"in s&&s.status;return(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh"},children:(0,b.jsx)("h3",{className:"text-danger col-5",children:(0,b.jsxs)(b.Fragment,{children:[" B\u0142\u0105d: ",m," "]})})})}}else e=i?d?(0,b.jsxs)("main",{className:"d-flex flex-column",style:{height:"100vh"},children:[(0,b.jsx)(O,{}),(0,b.jsx)(z,{})]}):(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center text-center",style:{height:"100vh"},children:(0,b.jsxs)("h3",{className:"text-warning text-center col-5",children:["Brak danych z miesi\u0105ca ",E.xk,". Dodaj miesi\u0105c za pomoc\u0105 formularza"]})}):(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center text-center",style:{height:"100vh"},children:(0,b.jsx)("h5",{className:"text-warning text-center col-5",children:"Brak  miesi\u0119cy zapisanych w bazie danych. Dodaj miesi\u0105c za pomoc\u0105 formularza"})});return(0,b.jsx)(b.Fragment,{children:e})}}}]);
//# sourceMappingURL=654.4a33a16d.chunk.js.map