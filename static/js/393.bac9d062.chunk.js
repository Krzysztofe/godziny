"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[393],{393:function(e,n,r){r.r(n),r.d(n,{default:function(){return U}});var d=r(1413),t=r(9439),i=r(2791),a=r(793),s=r(7689),o=r(322),l=r(4165),u=r(3433),c=r(5861),m=r(6355),h=r(1830),v=r.n(h),f=r(184),x=function(e){return(0,f.jsxs)("div",{children:[(0,f.jsxs)("small",{children:["Imi\u0119:",e.day.userName]}),(0,f.jsx)("small",{children:e.day.date}),(0,f.jsxs)("small",{children:["Godz.: ",e.day.hours]})]})},p=r(6712),y=function(e){var n,r=(0,o.S$)(void 0),i=r.data,h=(r.error,(0,o.CB)()),y=(0,t.Z)(h,2),Z=y[0],j=y[1],b=(0,s.UO)().monthURL,g=(0,p.Z)(b),H=g.databaseColumns,w=(g.databaseAllHours,g.databaseMonth),C=(g.acceptedHoursSum,g.rejectedHoursSum,g.submitedHoursSum,function(){var e=(0,c.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v().fire({title:"Chcesz usun\u0105\u0107 dzie\u0144?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}).then(function(){var e=(0,c.Z)((0,l.Z)().mark((function e(r){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isConfirmed){e.next=4;break}return t=(0,u.Z)(H).map((function(e){return e&&e.days?(0,d.Z)((0,d.Z)({},e),{},{days:e.days.filter((function(e){return e.id!==n}))}):e})),e.next=4,Z({id:i&&(null===w||void 0===w?void 0:w.id),columns:(0,d.Z)((0,d.Z)({},w),{},{columns:t})});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),S=(0,f.jsx)("div",{style:{border:"1px solid black"},children:(0,f.jsx)(a._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id.toString()),index:e.index,children:function(n){return(0,f.jsxs)("div",(0,d.Z)((0,d.Z)((0,d.Z)({},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[(0,f.jsx)(x,{day:e.day}),(0,f.jsx)("button",{onClick:function(){return C(e.day.id)},children:(0,f.jsx)(m.AMf,{})})]}))}})});return j.isLoading&&(S=(0,f.jsx)("div",{children:' "Loading" '})),j.isError&&(S=(0,f.jsx)("div",{children:' "B\u0142\u0105d" '})),(0,f.jsx)(f.Fragment,{children:S})},Z=function(e){return(0,f.jsx)("div",{children:(0,f.jsx)(a.bK,{droppableId:e.column.id,children:function(n,r){var t,i;return(0,f.jsxs)("div",(0,d.Z)((0,d.Z)({},n.droppableProps),{},{ref:n.innerRef,style:{border:"1px solid black",width:"20vw",minHeight:"100vh",height:"fit-content"},children:[e.column.days&&e.column.days.length>0&&(null===(t=e.column)||void 0===t||null===(i=t.days)||void 0===i?void 0:i.map((function(e,n){return(0,f.jsx)(y,{day:e,index:n},crypto.randomUUID())}))),n.placeholder]}))}})})},j=r(3360),b=r(3855),g=r(4849),H=r(8820),w=r(5705),C=r(8007),S=C.Ry({allHours:C.Rx().max(320,"Max. 320").required("Podaj liczb\u0119 godzin")}),k=function(){var e=(0,s.UO)().monthURL,n=(0,o.CB)(),r=(0,t.Z)(n,2),i=r[0],a=r[1],u=(0,p.Z)(e),m=u.databaseMonth,h=u.data,v=(0,w.TA)({initialValues:{allHours:0},validationSchema:S,onSubmit:function(){var e=(0,c.Z)((0,l.Z)().mark((function e(n,r){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.resetForm,e.next=3,i({id:h&&(null===m||void 0===m?void 0:m.id),columns:(0,d.Z)((0,d.Z)({},m),{},{allHours:n.allHours})});case 3:t();case 4:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()});return{formik:v,success:a}},I=function(){var e=k(),n=e.formik,r=e.success,d=(0,f.jsx)(H.dEn,{style:{fontSize:"2rem"}});return r.isLoading&&(d=(0,f.jsx)(g.Z,{animation:"border",variant:"secondary",children:(0,f.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),r.isError&&(d=(0,f.jsx)("div",{children:' "B\u0142\u0105d" '})),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(b.Z,{onSubmit:n.handleSubmit,className:"",children:(0,f.jsxs)(b.Z.Group,{className:"d-flex align-items-end my-3",style:{height:"2rem"},children:[(0,f.jsx)(b.Z.Label,{htmlFor:"allHours",className:"mb-0",children:"Podaj ilo\u015b\u0107 godzin"}),(0,f.jsxs)("div",{className:"align-self-start",children:[(0,f.jsx)(b.Z.Control,{id:"allHours",type:"number",name:"allHours",min:1,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,size:"sm",className:"rounded-0 ms-2",style:{width:"4rem"}}),(0,f.jsx)(b.Z.Text,{className:"text-danger d-block mt-0 mb-1 lh-0 ms-2",style:{fontSize:"0.7rem",height:"1rem"},children:n.touched.allHours&&n.errors.allHours&&n.errors.allHours})]}),(0,f.jsx)(j.Z,{type:"submit",variant:"secondary",className:"rounded-0 d-flex align-items-center justify-content-center px-0  bg-transparent  text-dark border-0",style:{width:"10%",height:"100%"},children:d})]})})})},B=r(7022),z=r(9743),N=r(2677),L=function(){var e=(0,s.UO)().monthURL,n=(0,p.Z)(e),r=n.databaseAllHours,d=n.dataCurrentHours,t=e&&new Date(e);t&&new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t);return(0,f.jsx)("header",{children:(0,f.jsx)(B.Z,{children:(0,f.jsxs)(z.Z,{children:[(0,f.jsx)(N.Z,{sm:7,className:"order-1 order-sm-2 px-0",children:(0,f.jsx)(I,{})}),(0,f.jsx)(N.Z,{sm:5,className:"order-2 order-sm-1 px-0",children:(0,f.jsxs)("div",{className:"d-flex my-3",children:[(0,f.jsxs)("div",{children:["Wszystkie: ",r]}),(0,f.jsxs)("div",{className:"ms-4",children:["Wolne: ",d]})]})})]})})})},A=r(3572),U=function(){var e=(0,o.S$)(void 0),n=e.data,r=e.error,l=(0,o.CB)(),u=(0,t.Z)(l,2),c=u[0],m=u[1],h=(0,s.UO)().monthURL,v=(0,p.Z)(h),x=v.databaseAllHours,y=v.databaseColumns,j=v.databaseAcceptedHours,b=v.databaseRejectedHours,g=v.dataBaseSubmitedHours,H=v.databaseMonth,w=v.submitedHoursSum,C=v.acceptedHoursSum,S=v.rejectedHoursSum,k=(0,i.useState)([]),I=(0,t.Z)(k,2),B=I[0],z=I[1];(0,i.useEffect)((function(){n&&H&&z(y)}),[n,h]),(0,i.useEffect)((function(){n&&(null===B||void 0===B?void 0:B.length)>1&&(null===H||void 0===H?void 0:H.month)&&c({id:n&&(null===H||void 0===H?void 0:H.id),columns:(0,d.Z)((0,d.Z)({},H),{},{columns:B,currentHours:x-w-C-S+S,submitedHours:w,acceptedHours:C,rejectedHours:S})})}),[B]);var N=m.isError?(0,f.jsx)("div",{children:"B\u0142\u0105d"}):(0,f.jsx)("div",{children:(0,f.jsx)("div",{children:(0,f.jsxs)(a.Z5,{onDragEnd:function(e){return(0,A.qs)(e,B,z)},children:[(0,f.jsx)("div",{style:{display:"flex"},children:[{header:"Z\u0142o\u017cone:",counter:g},{header:"Zakceptowane:",counter:j},{header:"Odrzucone:",counter:b}].map((function(e){var n=e.header,r=e.counter;return(0,f.jsxs)("h6",{style:{marginLeft:20,width:"20vw"},children:[n," ","",r]},n)}))}),(0,f.jsx)("div",{style:{display:"flex"},children:B&&B.length>0&&B.map((function(e,n){return(0,f.jsx)(Z,{column:e},e.id)}))})]})})});return r&&"error"in r&&(N=(0,f.jsxs)("div",{style:{textAlign:"center"},children:[" ",r.error," "]})),(0,f.jsx)(f.Fragment,{children:void 0===H||null===H?(0,f.jsx)("div",{style:{textAlign:"center"},children:"Brak danych, wybierz miesi\u0105c"}):(0,f.jsx)("div",{style:{display:"flex",marginLeft:"30vw"},children:(0,f.jsxs)("div",{children:[(0,f.jsx)(L,{}),N]})})})}},6712:function(e,n,r){var d=r(1413),t=r(322),i=r(3572);n.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(0,t.S$)(void 0).data,r=n&&Object.keys(n),a=r&&Object.values(n).flat().map((function(e,n){return(0,d.Z)((0,d.Z)({},e),{},{id:r[n]})})),s=(0,i.nr)(a),o=n&&s.length>0?null===s||void 0===s?void 0:s.find((function(n){return n.month===e})):void 0,l=n&&(null===o||void 0===o?void 0:o.columns),u=n?null===o||void 0===o?void 0:o.allHours:"",c=n?null===o||void 0===o?void 0:o.currentHours:"",m=n?null===o||void 0===o?void 0:o.submitedHours:"",h=n?null===o||void 0===o?void 0:o.acceptedHours:"",v=n?null===o||void 0===o?void 0:o.rejectedHours:"",f=n&&s.length>0&&null!==l&&void 0!==l&&l[0].days?null===l||void 0===l?void 0:l[0].days.reduce((function(e,n){return e+n.hours}),0):0,x=n&&s.length>0&&null!==l&&void 0!==l&&l[0].days?null===l||void 0===l?void 0:l[1].days.reduce((function(e,n){return e+n.hours}),0):0,p=n&&s.length>0&&null!==l&&void 0!==l&&l[0].days?null===l||void 0===l?void 0:l[2].days.reduce((function(e,n){return e+n.hours}),0):0,y=n&&s?s.map((function(e){return e.month})):[];return{string:y.map((function(e){var n=new Date(e);return new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(n)})),data:n,databaseMonthsId:r,databaseMonthsCollection:s,databaseMonth:o,databaseColumns:l,databaseAllHours:u,dataCurrentHours:c,databaseAcceptedHours:h,databaseRejectedHours:v,dataBaseSubmitedHours:m,acceptedHoursSum:x,rejectedHoursSum:p,submitedHoursSum:f,databaseMonthsDates:y}}},3572:function(e,n,r){r.d(n,{nr:function(){return a},qs:function(){return s}});var d=r(9439),t=r(3433),i=r(1413),a=function(e){return Array.isArray(e)?null===e||void 0===e?void 0:e.map((function(e){var n,r;return(null===e||void 0===e||null===(n=e.columns)||void 0===n?void 0:n.every((function(e){return e.hasOwnProperty("days")})))?e:(0,i.Z)((0,i.Z)({},e),{},{columns:null===e||void 0===e||null===(r=e.columns)||void 0===r?void 0:r.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{days:e.days||[]})}))})})):[]},s=function(e,n,r){var a=e.source,s=e.destination;if(s&&(a.draggableId!==s.droppableId||a.index===s.index))if(a.droppableId!==s.droppableId){var o=n.findIndex((function(e){return e.id===a.droppableId})),l=n.findIndex((function(e){return e.id===s.droppableId})),u=(0,t.Z)(n[o].days),c=a.droppableId!==s.dropableId?(0,t.Z)(n[l].days):u,m=u.splice(a.index,1),h=(0,d.Z)(m,1)[0];c.splice(s.index,0,h);var v=(0,t.Z)(n);v[o]=(0,i.Z)((0,i.Z)({},n[o]),{},{days:u}),v[l]=(0,i.Z)((0,i.Z)({},n[l]),{},{days:c}),r(v)}else{var f=s.index,x=n.findIndex((function(e){return e.id===a.droppableId})),p=(0,t.Z)(n[x].days),y=p.splice(a.index,1),Z=(0,d.Z)(y,1)[0];p.splice(f,0,Z);var j=(0,t.Z)(n);j[x]=(0,i.Z)((0,i.Z)({},n[x]),{},{days:p}),r(j)}}}}]);
//# sourceMappingURL=393.bac9d062.chunk.js.map