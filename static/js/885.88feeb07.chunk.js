"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[885],{9662:function(e,n,r){r.d(n,{j0:function(){return l},nt:function(){return d},st:function(){return c},vs:function(){return s},xk:function(){return u}});var t=new Date,a=function(e){var n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(t)},o=new Date(t.getTime()+12096e5),i=new Date(t.getTime()+5184e6),l=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),d=(String(t.getDate()).padStart(2,"0"),a(t),a(o)),c=a(i),u=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t)},1100:function(e,n,r){var t=r(1830),a=r.n(t),o=r(2791),i=r(4849),l=r(184);n.Z=function(e,n){(0,o.useEffect)((function(){if(e.isError){var n=e.error,r=n&&"status"in n&&n.status&&n.status;a().fire({title:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[e.isError]);var r=n;return e.isLoading&&(r=(0,l.jsx)(i.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},9065:function(e,n,r){var t=r(7689);n.Z=function(){var e=(0,t.TH)().pathname.split("/").slice(-1)[0],n=null===e||void 0===e?void 0:e.slice(0,4),r=null===e||void 0===e?void 0:e.slice(-2);return{monthURL:e,yearFromURL:n,monthFromURL:r}}},1885:function(e,n,r){r.r(n),r.d(n,{default:function(){return q}});var t=r(4849),a=r(9662),o=r(9065),i=r(3210),l=r(1413),s=r(9439),d=r(2791),c=r(793),u=r(7022),m=r(9743),v=r(4165),x=r(5861),h=r(3360),f=r(1830),p=r.n(f),y=r(1100),g=r(6856),j=r(1578),b=r(184),Z=function(e){var n,r;if(null!==e&&void 0!==e&&null!==(n=e.day)&&void 0!==n&&n.date){var t,a,o=new Date(e.day.date);return r=new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(o),(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between fs-7",children:[(0,b.jsx)("div",{children:null===(t=e.day)||void 0===t?void 0:t.userName}),(0,b.jsx)("div",{children:"Poza"===(null===(a=e.day)||void 0===a?void 0:a.place)?(0,b.jsx)(j.ols,{style:{color:"rgb(80,173,150)"}}):(0,b.jsx)(g.P8U,{style:{color:"rgb(180,160,255)"}})})]}),(0,b.jsx)("div",{className:"d-flex fw-medium justify-content-between",children:(0,b.jsx)("div",{children:r||""})})]})}return(0,b.jsx)("div",{children:"Brak danych"})},N=r(3853),H=r(7425),w=function(e){var n,r=(0,o.Z)(),t=r.yearFromURL,a=r.monthFromURL,d=(0,i.a6)({year:t,month:a}).data,u=(0,i.ur)(),m=(0,s.Z)(u,2),f=m[0],g=m[1],j=(0,y.Z)(g,(0,b.jsx)(H.GnT,{className:"text-danger"})).btnContent,w=function(){var n=(0,x.Z)((0,v.Z)().mark((function n(r,o){return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:p().fire({title:"Chcesz usun\u0105\u0107 dzie\u0144?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}).then(function(){var n=(0,x.Z)((0,v.Z)().mark((function n(i){var l,s,c;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!i.isConfirmed){n.next=4;break}return c=null===d||void 0===d||null===(l=d.columns[r])||void 0===l||null===(s=l.days)||void 0===s?void 0:s.filter((function(e){return(null===e||void 0===e?void 0:e.id)!==o})),n.next=4,f({year:t,month:a,colIdx:e.columnIdx,daysBody:c||[]});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}();return(0,b.jsx)(c._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id),index:e.dayIdx,isDragDisabled:!1,children:function(n,r){var t;return(0,b.jsxs)("div",(0,l.Z)((0,l.Z)((0,l.Z)({className:"bg-white card mb-2 px-1 py-2 py-sm-1 ".concat(r.isDragging?"border-dark":"border")},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[(0,b.jsx)(Z,{day:e.day}),(0,b.jsxs)(h.Z,{onClick:function(){return w(e.columnIdx,e.day.id)},className:"d-flex justify-content-between  align-items-center p-0 bg-transparent border-0",disabled:g.isLoading,children:[(0,b.jsxs)("div",{className:"d-flex align-items-center fs-7",children:[null===(t=e.day)||void 0===t?void 0:t.hours," ",(0,b.jsx)(N.TCC,{className:"  ms-1"})]}),(0,b.jsx)("div",{className:"d-flex align-items-center",children:j})]})]}))}})},L=r(2677),z=function(e){return(0,b.jsx)(L.Z,{className:"p-0",children:(0,b.jsx)(c.bK,{droppableId:e.column.id,children:function(n,r){return(0,b.jsxs)("div",(0,l.Z)((0,l.Z)({},n.droppableProps),{},{ref:n.innerRef,className:"p-1 h-100 ".concat(r.isDraggingOver?"bg-dark-subtle":"bg-primary"),children:[Array.isArray(e.column.days)?e.column.days.map((function(n,r){return(0,b.jsx)(w,{day:n,columnIdx:e.columnIdx,dayIdx:r},crypto.randomUUID())})):[],n.placeholder]}))}})})},k=function(e){var n=(0,o.Z)(),r=n.yearFromURL,t=n.monthFromURL,a=(0,i.I8)({year:r,month:t}).data;return(0,b.jsx)(b.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===a||void 0===a?void 0:a.submittedHours},{headerText:"Przyznane:",counter:null===a||void 0===a?void 0:a.acceptedHours},{headerText:"Odrzucone:",counter:null===a||void 0===a?void 0:a.rejectedHours}].map((function(n){var r=n.headerText,t=n.counter;return(0,b.jsxs)(L.Z,{className:"bg-primary text-dark-emphasis fw-medium p-1 ".concat(0===e.thumbPosition?"":" border-bottom border-1 border-dark-subtle"),style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[r," ","",t]},r)}))})},F=r(3433),I=function(e){return Array.isArray(e)?null===e||void 0===e?void 0:e.map((function(e){return null!==e&&void 0!==e&&e.hasOwnProperty("days")?e:(0,l.Z)((0,l.Z)({},e),{},{days:[]})})):[]},S=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.a6)({year:n,month:r}).data;if(t){var a,l,s,d,c,u,m=I(null===t||void 0===t?void 0:t.columns);return{submittedHoursSum:t&&m&&(null===(a=m[0])||void 0===a||null===(l=a.days)||void 0===l?void 0:l.reduce((function(e,n){var r;return e+(null!==(r=null===n||void 0===n?void 0:n.hours)&&void 0!==r?r:0)}),0)),acceptedHoursSum:t&&m&&(null===(s=m[1])||void 0===s||null===(d=s.days)||void 0===d?void 0:d.reduce((function(e,n){var r;return e+(null!==(r=null===n||void 0===n?void 0:n.hours)&&void 0!==r?r:0)}),0)),rejectedHoursSum:t&&m&&(null===(c=m[2])||void 0===c||null===(u=c.days)||void 0===u?void 0:u.reduce((function(e,n){var r;return e+(null!==(r=null===n||void 0===n?void 0:n.hours)&&void 0!==r?r:0)}),0))}}return{submittedHoursSum:0,acceptedHoursSum:0,rejectedHoursSum:0}},R=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.a6)({year:n,month:r}).data,a=(0,i.X)(),v=(0,s.Z)(a,1)[0],x=(0,i.ej)(),h=(0,s.Z)(x,1)[0],f=null!==t&&void 0!==t&&t.columns?I(t.columns):[],p=S(),y=p.submittedHoursSum,g=p.acceptedHoursSum,j=p.rejectedHoursSum,Z=(0,d.useState)([]),N=(0,s.Z)(Z,2),H=N[0],w=N[1],L=(0,d.useState)(null),R=(0,s.Z)(L,2),U=R[0],C=R[1];(0,d.useEffect)((function(){w(f)}),[t]),(0,d.useEffect)((function(){null!==U&&v({year:n,month:r,columnsBody:H})}),[U]),(0,d.useEffect)((function(){var e,a;h({year:n,month:r,allHours:(0,l.Z)((0,l.Z)({},null===t||void 0===t?void 0:t.calc),{},{currentHours:(null!==(e=null===t||void 0===t||null===(a=t.calc)||void 0===a?void 0:a.allHours)&&void 0!==e?e:0)-y-g-j+j,submittedHours:y,acceptedHours:g,rejectedHours:j})})}),[t]);var D=(0,d.useRef)(null),T=(0,d.useState)(0),B=(0,s.Z)(T,2),P=B[0],E=B[1];return(0,b.jsx)(u.Z,{fluid:!0,ref:D,onScroll:function(){var e=D.current;if(e){var n=e.scrollTop,r=e.scrollHeight,t=e.clientHeight;E(n/(r-t)*100)}},className:" mb-1 overflow-y-scroll",style:{top:"".concat(P,"%")},children:(0,b.jsxs)("div",{className:"",children:[(0,b.jsx)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1 sticky-top",children:(0,b.jsx)(k,{thumbPosition:P})}),(0,b.jsx)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1",style:{height:"fit-content"},children:(0,b.jsx)(c.Z5,{onDragEnd:function(e){!function(e,n,r){var t=e.source,a=e.destination;if(a&&(t.draggableId!==a.droppableId||t.index===a.index))if(t.droppableId!==a.droppableId){var o=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===t.droppableId})),i=null===n||void 0===n?void 0:n.findIndex((function(e){return e.id===a.droppableId})),d=n&&(0,F.Z)(n[o].days),c=t.droppableId!==a.dropableId?(0,F.Z)(n[i].days):d,u=d.splice(t.index,1),m=(0,s.Z)(u,1)[0];c.splice(a.index,0,m);var v=(0,F.Z)(n);v[o]=(0,l.Z)((0,l.Z)({},n[o]),{},{days:d}),v[i]=(0,l.Z)((0,l.Z)({},n[i]),{},{days:c}),r(v)}else{var x=a.index,h=n.findIndex((function(e){return e.id===t.droppableId})),f=(0,F.Z)(n[h].days),p=f.splice(t.index,1),y=(0,s.Z)(p,1)[0];f.splice(x,0,y);var g=(0,F.Z)(n);g[h]=(0,l.Z)((0,l.Z)({},n[h]),{},{days:f}),r(g)}}(e,H,w),C(e)},children:null===H||void 0===H?void 0:H.map((function(e,n){return(0,b.jsx)(z,{column:e,columnIdx:n},e.id)}))})})]})})},U=r(7858),C=r(3855),D=r(5705),T=r(8007),B=T.Ry({allHours:T.Rx().max(320,"Max. 320").required("Podaj liczb\u0119 godzin")}),P=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.I8)({year:n,month:r}).data,a=(0,i.uZ)(),l=(0,s.Z)(a,2),d=l[0],c=l[1],u=(0,D.TA)({initialValues:{allHours:0},validationSchema:B,onSubmit:function(){var e=(0,x.Z)((0,v.Z)().mark((function e(a){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===t||void 0===t?void 0:t.submittedHours)+(null===t||void 0===t?void 0:t.acceptedHours)>+u.values.allHours)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d({year:n,month:r,allHours:+a.allHours});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()});return{formik:u,success:c}},E=function(){var e=P(),n=e.formik,r=e.success,t=(0,o.Z)(),a=t.yearFromURL,l=t.monthFromURL,s=(0,i.I8)({year:a,month:l}).data,d=(0,y.Z)(r,"Zapisz liczb\u0119 godzin").btnContent,c="linear-gradient(to right, rgba(180,160,255) ".concat(n.values.allHours,"%, rgba(231, 227, 243) ").concat(n.values.allHours,"%, rgba(231, 227, 243) 100%)");return(0,b.jsxs)(C.Z,{onSubmit:n.handleSubmit,className:"p-2 bg-primary rounded-bottom-1",children:[(0,b.jsx)(C.Z.Control,{type:"number",name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,placeholder:"Liczba",size:"sm",className:"p-0 px-1 mx-auto mb-2 border border-primary",style:{minHeight:0,cursor:"pointer",width:"fit-content"}}),(0,b.jsx)("div",{className:"text-danger d-block mt-0 fs-8 text-center",style:{height:"0.7rem"},children:(null===s||void 0===s?void 0:s.submittedHours)+(null===s||void 0===s?void 0:s.acceptedHours)>+n.values.allHours?"Podaj ilo\u015b\u0107 godzin wi\u0119ksz\u0105 od ".concat((null===s||void 0===s?void 0:s.submittedHours)+(null===s||void 0===s?void 0:s.acceptedHours)," "):""}),(0,b.jsxs)(C.Z.Group,{className:"mt-2 d-flex align-items-center w-100",children:[(0,b.jsx)("div",{className:"fw-medium",children:"0"}),(0,b.jsx)(C.Z.Range,{name:"allHours",min:0,max:320,value:n.values.allHours,onChange:n.handleChange,onBlur:n.handleBlur,className:"form-range custom-range mx-2 medium",style:{height:10,background:c}}),(0,b.jsx)("div",{className:"fw-medium",children:"320"})]}),(0,b.jsx)(h.Z,{type:"submit",variant:"info",size:"sm",className:"fw-medium d-block mx-auto mt-2 col-sm-6 col-md-4 col-lg-3 col-xxl-2",disabled:r.isLoading,children:d})]})},A=function(){var e=(0,d.useState)(!1),n=(0,s.Z)(e,2),r=n[0],t=n[1];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(h.Z,{onClick:function(){return t(!r)},"aria-controls":"example-collapse-text","aria-expanded":r,className:"fw-medium w-100 mt-1 d-flex justify-content-center align-items-center bg-primary ".concat(r?"rounded-bottom-0":""),children:["Liczba godzin w miesi\u0105cu",(0,b.jsx)(g.x3N,{className:"fs-1 fw-medium",style:{transform:"".concat(r?"rotate(180deg)":""," "),transitionDuration:"320ms"}})]}),(0,b.jsx)(U.Z,{in:r,children:(0,b.jsx)("div",{className:"bg-white p-0",children:(0,b.jsx)(E,{})})})]})},O=r(7689),M=function(){var e=(0,O.UO)().monthURL,n=e&&new Date(e);return{monthURLStringFormat:n&&new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(n)}},G=function(){var e=(0,o.Z)(),n=e.yearFromURL,r=e.monthFromURL,t=(0,i.I8)({year:n,month:r}).data,a=M().monthURLStringFormat;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-capitalize fw-medium mt-2 text-center d-md-none",children:a}),(0,b.jsxs)("div",{className:" d-flex justify-content-center my-2 fw-medium position-relative",children:[(0,b.jsx)("div",{className:"text-capitalize fw-medium d-none d-md-block  position-absolute end-0",children:a}),(0,b.jsx)("div",{className:"col-3 text-end",children:"Wszystkie"}),(0,b.jsxs)("div",{className:"mx-2",children:[null===t||void 0===t?void 0:t.allHours," -"," ",(0,b.jsx)("span",{className:"".concat((null===t||void 0===t?void 0:t.currentHours)<0?"text-danger":""),children:null===t||void 0===t?void 0:t.currentHours})]}),(0,b.jsx)("div",{className:"col-3 ".concat((null===t||void 0===t?void 0:t.currentHours)<0?"text-danger":""),children:(null===t||void 0===t?void 0:t.currentHours)<0?"Brak":"Dost\u0119pne"})]})]})},Y=function(){return(0,b.jsx)("header",{className:"me-3",children:(0,b.jsx)(u.Z,{fluid:!0,children:(0,b.jsxs)(m.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 ms-sm-auto mx-xl-auto px-1 ",children:[(0,b.jsx)(A,{}),(0,b.jsx)(G,{})]})})})},q=function(){var e,n=(0,o.Z)(),r=n.yearFromURL,l=n.monthFromURL,s=(0,i.S$)(void 0),d=s.data,c=s.error,u=s.isLoading,m=(0,i.a6)({year:r,month:l}).data;if(u)e=(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh"},children:(0,b.jsx)(t.Z,{animation:"border",variant:"secondary",children:(0,b.jsx)("span",{className:"visually-hidden",children:"Loading..."})})});else if(c){if("status"in c){var v="status"in c&&c.status;return(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh"},children:(0,b.jsx)("h3",{className:"text-danger col-5",children:(0,b.jsxs)(b.Fragment,{children:[" B\u0142\u0105d: ",v," "]})})})}}else e=d?m?(0,b.jsxs)("main",{className:"d-flex flex-column bg-primary-subtle",style:{height:"100vh"},children:[(0,b.jsx)(Y,{}),(0,b.jsx)(R,{})]}):(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center text-center",style:{height:"100vh"},children:(0,b.jsxs)("h3",{className:"text-warning text-center col-5",children:["Brak danych z miesi\u0105ca ",a.xk,". Dodaj miesi\u0105c za pomoc\u0105 formularza"]})}):(0,b.jsx)("main",{className:"d-flex justify-content-center align-items-center text-center",style:{height:"100vh"},children:(0,b.jsx)("h5",{className:"text-warning text-center col-5",children:"Brak miesi\u0119cy zapisanych w bazie danych. Dodaj miesi\u0105c za pomoc\u0105 formularza"})});return(0,b.jsx)(b.Fragment,{children:e})}}}]);
//# sourceMappingURL=885.88feeb07.chunk.js.map