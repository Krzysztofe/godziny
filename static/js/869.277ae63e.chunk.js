"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[869],{8869:function(e,n,a){a.r(n),a.d(n,{default:function(){return P}});var r=a(9439),d=a(2791),s=a(7371),l=a(5048),u=a(1413),t=a(4165),o=a(5861),i=a(6355),c=a(184),m=function(e){return(0,c.jsxs)("div",{children:[(0,c.jsxs)("small",{children:["Imi\u0119:",e.day.userName]}),(0,c.jsx)("small",{children:e.day.date}),(0,c.jsxs)("small",{children:["Godz.: ",e.day.hours]})]})},h=a(3433),p=a(322),f=a(411),v=function(){var e,n,a,s,t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=(0,l.I0)(),c=(0,p.P2)(void 0),m=c.data,v=c.error,y=(0,p.l4)(),x=(0,r.Z)(y,2),j=x[0],b=x[1],g=(0,p.X)(),Z=(0,r.Z)(g,1)[0],C=m&&Object.keys(m).join(),k=m?Object.values(m).flat():[],H=m&&k.length>0?null===(e=k[0])||void 0===e?void 0:e.allHours:"",I=m&&k.length>0?null===(n=k[0])||void 0===n?void 0:n.pendingHours:"",z=m&&k.length>0?null===(a=k[0])||void 0===a?void 0:a.columns:[],w=null===(t=z)||void 0===t?void 0:t.map((function(e){return e.hasOwnProperty("days")?e:(0,u.Z)((0,u.Z)({},e),{},{days:[]})})),D=m?(0,h.Z)(w):[];D[0]=m&&(null===z||void 0===z?void 0:z.length)>0&&(0,u.Z)((0,u.Z)({},null===w||void 0===w?void 0:w[0]),{},{days:[].concat((0,h.Z)(null===w||void 0===w||null===(s=w[0])||void 0===s?void 0:s.days),[o])});var P=m?(0,h.Z)(w):[],B=m&&k.length>0?w[0].days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):[];return(0,d.useEffect)((function(){i((0,f.w8)(b.isLoading))}),[b.isLoading,i]),console.log("",B),{dataBaseAllHours:H,dataBasePendingHours:I,dataBaseColumnsId:C,updatedColumnsWithAddedDays:D,newColumnsFromDatabase:P,databaseColumns:w,usersHoursSum:B,data:m,error:v,success:b,updateColumns:Z,addDays:j}},y=function(e){(0,l.v9)((function(e){return e.hoursPanel})).numberOfDays;var n,a=v(),r=a.dataBaseColumnsId,d=a.newColumnsFromDatabase,h=a.usersHoursSum,p=a.dataBaseAllHours,f=a.updateColumns,y=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(n){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.map((function(e){return e&&e.days?(0,u.Z)((0,u.Z)({},e),{},{days:e.days.filter((function(e){return e.id!==n}))}):e})),e.next=3,f({id:r,columns:{allHours:p,pendingHours:h,columns:a}});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,c.jsx)("div",{style:{border:"1px solid black"},children:(0,c.jsx)(s._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id.toString()),index:e.index,children:function(n){return(0,c.jsxs)("div",(0,u.Z)((0,u.Z)((0,u.Z)({},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[(0,c.jsx)("strong",{children:e.day.content}),(0,c.jsx)(m,{day:e.day}),(0,c.jsx)("button",{onClick:function(){return y(e.day.id)},children:(0,c.jsx)(i.AMf,{})})]}))}})})},x=function(e){return(0,c.jsxs)("div",{children:[(0,c.jsxs)("h4",{children:[e.column.columnName," "]}),(0,c.jsx)(s.bK,{droppableId:e.column.id,children:function(n,a){var r,d;return(0,c.jsxs)("div",(0,u.Z)((0,u.Z)({},n.droppableProps),{},{ref:n.innerRef,style:{border:"1px solid black",width:"30vw",minHeight:"100vh",height:"fit-content"},children:[e.column.days&&e.column.days.length>0&&(null===(r=e.column)||void 0===r||null===(d=r.days)||void 0===d?void 0:d.map((function(e,n){return(0,c.jsx)(y,{day:e,index:n},crypto.randomUUID())}))),n.placeholder]}))}})]})},j=function(e){return(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:e.name,children:e.label}),(0,c.jsx)("input",{id:e.name,type:e.type,name:e.name,value:e.value,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:e.placeholder,style:{width:50}})]})},b=function(){var e=(0,l.I0)(),n=(0,l.v9)((function(e){return e.hoursPanel})).numberOfDays,a=(0,p.iq)(),d=(0,r.Z)(a,2),s=d[0],u=(d[1],v()),i=u.dataBaseColumnsId,m=(u.dataBaseAllHours,u.dataBasePendingHours),h=u.updatedColumnsWithAddedDays,y=(u.databaseColumns,u.data),x=u.updateColumns,b=y&&Object.keys(y).join(),g=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(b);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x({id:i,columns:{allHours:+n,pendingHours:m,columns:h}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)("header",{children:[(0,c.jsx)(j,{type:"number",name:"numberOfDays",value:n,label:"Godziny w miesi\u0105cu ",placeholder:"Dni",handleChange:function(n){var a=n.target.value;e((0,f.Cp)(a))}}),(0,c.jsx)("button",{onClick:Z,children:"Dodaj godziny"}),(0,c.jsx)("button",{onClick:g,children:" usu\u0144 wszystko"})]})},g=a(3728),Z=function(e){return(0,c.jsxs)("div",{className:e.containerClass,children:[(0,c.jsx)("input",{type:"radio",name:e.name,value:e.value,checked:e.checked,onChange:e.handleChange,className:e.inuptClass,id:e.value}),(0,c.jsx)("label",{htmlFor:e.value,className:e.labelClass,children:(0,c.jsxs)("small",{children:[" ",e.label?e.label:e.value]})})]})},C=a(5705),k={id:crypto.randomUUID(),date:"",hours:"",userName:"",place:""},H={allHours:0,pendingHours:0,columns:[{id:"miesiac",columnName:"Miesi\u0105c",days:[]},{id:"oczekuj\u0105ce",columnName:"Oczekuj\u0105ce"},{id:"zatwierdzone",columnName:"Zatwierdzone"}]},I=a(6727),z=I.Ry({userName:I.Z_().required("Podaj imi\u0119"),date:I.Z_().required("Podaj dat\u0119"),hours:I.Rx().required("Podaj liczb\u0119 godzin").moreThan(0,"Liczba godzin musi by\u0107 wi\u0119ksza od 0"),place:I.Z_().required("Podaj lokalizacj\u0119")}),w=function(){(0,l.v9)((function(e){return e.hoursPanel})).numberOfDays;var e=(0,C.TA)({initialValues:k,validationSchema:z,onSubmit:function(){var n=(0,o.Z)((0,t.Z)().mark((function n(l){return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.setFieldValue("id",crypto.randomUUID()),H.columns[0].days=[l],null!==s){n.next=7;break}return n.next=5,c(H);case 5:n.next=9;break;case 7:return n.next=9,i({id:r,columns:{allHours:a,pendingHours:u,columns:d}});case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),n=v(e.values),a=n.dataBaseAllHours,r=(n.dataBasePendingHours,n.dataBaseColumnsId),d=n.updatedColumnsWithAddedDays,s=n.data,u=n.usersHoursSum,i=(n.success,n.updateColumns),c=n.addDays;return{formik:e}},D=function(){(0,l.I0)();var e=(0,l.v9)((function(e){return e.hoursPanel})).requestState,n=w().formik;return(0,c.jsxs)("form",{onSubmit:n.handleSubmit,style:{marginTop:20},children:[[{type:"text",value:"userName",label:"Imi\u0119"},{type:"date",value:"date",label:"Dzie\u0144"},{type:"number",value:"hours",label:"Godz."}].map((function(e){var a=e.type,r=e.value,d=e.label;return(0,c.jsxs)("div",{children:[(0,c.jsx)(j,{type:a,name:r,value:n.values[r],label:d,placeholder:d,handleChange:n.handleChange,handleBlur:n.handleBlur}),(0,c.jsx)("div",{style:{color:"red"},children:n.touched[r]&&n.errors[r]&&(0,c.jsx)("small",{children:n.errors[r]})})]},r)})),["Wewn\u0105trz","Poza"].map((function(e){return(0,c.jsx)(Z,{value:e,name:"place",handleChange:n.handleChange,checked:n.values.place===e},e)})),(0,c.jsx)("div",{style:{color:"red"},children:n.touched.place&&n.errors.place&&(0,c.jsx)("small",{children:n.errors.place})}),(0,c.jsx)(c.Fragment,{children:e.edit.isLoading?"loading":"uu"}),(0,c.jsx)("button",{type:"submit",children:(0,c.jsx)(g.pl2,{})})]})},P=function(){var e=(0,l.v9)((function(e){return e.hoursPanel})).numberOfDays,n=v(),a=n.dataBaseAllHours,t=n.dataBasePendingHours,o=n.dataBaseColumnsId,i=n.databaseColumns,m=n.usersHoursSum,p=n.data,f=n.updateColumns,y=(0,d.useState)(0),j=(0,r.Z)(y,2),g=j[0],Z=j[1],C=(0,d.useState)(0),k=(0,r.Z)(C,2),H=k[0],I=k[1],z=(0,d.useState)([]),w=(0,r.Z)(z,2),P=w[0],B=w[1];return(0,d.useEffect)((function(){Z(a)}),[p]),(0,d.useEffect)((function(){I(t)}),[p]),(0,d.useEffect)((function(){B(i)}),[p]),(0,d.useEffect)((function(){o&&f({id:o,columns:{allHours:g,pendingHours:m,columns:P}})}),[P,e]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(b,{}),(0,c.jsx)(D,{}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{children:["wszystkie godziny: ",a-t," "]}),(0,c.jsxs)("p",{children:["oczekuj\u0105ce godziny: ",H]}),(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(s.Z5,{onDragEnd:function(e){return function(e,n,a){var d=e.source,s=e.destination;if(s&&(d.draggableId!==s.droppableId||d.index===s.index))if(d.droppableId!==s.droppableId){var l=n.findIndex((function(e){return e.id===d.droppableId})),t=n.findIndex((function(e){return e.id===s.droppableId})),o=(0,h.Z)(n[l].days),i=d.droppableId!==s.dropableId?(0,h.Z)(n[t].days):o,c=o.splice(d.index,1),m=(0,r.Z)(c,1)[0];i.splice(s.index,0,m);var p=(0,h.Z)(n);p[l]=(0,u.Z)((0,u.Z)({},n[l]),{},{days:o}),p[t]=(0,u.Z)((0,u.Z)({},n[t]),{},{days:i}),a(p)}else{var f=s.index,v=n.findIndex((function(e){return e.id===d.droppableId})),y=(0,h.Z)(n[v].days),x=y.splice(d.index,1),j=(0,r.Z)(x,1)[0];y.splice(f,0,j);var b=(0,h.Z)(n);b[v]=(0,u.Z)((0,u.Z)({},n[v]),{},{days:y}),a(b)}}(e,P,B)},children:P&&P.length>0&&P.map((function(e,n){return(0,c.jsx)(x,{column:e},e.id)}))})})]})]})}}}]);
//# sourceMappingURL=869.277ae63e.chunk.js.map