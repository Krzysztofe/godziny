"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[51],{9662:function(n,e,r){r.d(e,{j0:function(){return l},nt:function(){return d},st:function(){return c},vs:function(){return s},xk:function(){return u}});var t=new Date,o=function(n){var e=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0");return"".concat(e,"-").concat(r,"-").concat(t)},i=new Date(t.getTime()+12096e5),a=new Date(t.getTime()+5184e6),l=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),d=(String(t.getDate()).padStart(2,"0"),o(t),o(i)),c=o(a),u=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t)},1100:function(n,e,r){var t=r(1830),o=r.n(t),i=r(2791),a=r(4849),l=r(184);e.Z=function(n,e){(0,i.useEffect)((function(){if(n.isError){var e=n.error,r=e&&"status"in e&&e.status&&e.status;o().fire({text:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[n.isError]);var r=e;return n.isLoading&&(r=(0,l.jsx)(a.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},9065:function(n,e,r){var t=r(7689);e.Z=function(){var n=(0,t.TH)().pathname.split("/").slice(-1)[0],e=null===n||void 0===n?void 0:n.slice(0,4),r=null===n||void 0===n?void 0:n.slice(-2);return{monthURL:n,yearFromURL:e,monthFromURL:r,isMonthInURL:/^\d{4}-\d{2}$/.test(n)}}},6051:function(n,e,r){r.r(e),r.d(e,{default:function(){return W}});var t=r(5048),o=r(9662),i=r(1413),a=r(9439),l=r(2791),s=r(793),d=r(7022),c=r(9743),u=r(7762),m=r(3433),v=function(n){return Array.isArray(n)?null===n||void 0===n?void 0:n.map((function(n){return null!==n&&void 0!==n&&n.hasOwnProperty("days")?n:(0,i.Z)((0,i.Z)({},n),{},{days:[]})})):[]},f=function(){var n,e=(0,t.v9)((function(n){return n.monthsPanel})).month,r=0,o=0,i=0,a=v(null===e||void 0===e?void 0:e.columns),l=(0,u.Z)(a);try{for(l.s();!(n=l.n()).done;){var s=n.value,d=(s.days||[]).reduce((function(n,e){var r;return n+(null!==(r=null===e||void 0===e?void 0:e.hours)&&void 0!==r?r:0)}),0);switch(s.id){case"submitted":r=d;break;case"accepted":o=d;break;case"rejected":i=d}}}catch(c){l.e(c)}finally{l.f()}return{submittedHoursSum:r,acceptedHoursSum:o,rejectedHoursSum:i}},h=r(9065),x=r(7615),p=r(2677),g=r(4165),b=r(5861),y=r(3360),j=r(3853),Z=r(7425),w=r(1830),N=r.n(w),H=r(1100),k=r(2767),z=r(6856),C=r(1578),I=r(184),S=function(n){var e,r;if(null!==n&&void 0!==n&&null!==(e=n.day)&&void 0!==e&&e.date){var t,o,i=new Date(n.day.date);return r=new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(i),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"d-flex justify-content-between fs-7",children:[(0,I.jsx)("div",{children:null===(t=n.day)||void 0===t?void 0:t.userName}),(0,I.jsx)("div",{children:"Poza"===(null===(o=n.day)||void 0===o?void 0:o.place)?(0,I.jsx)(C.ols,{style:{color:"rgb(80,173,150)"}}):(0,I.jsx)(z.P8U,{style:{color:"rgb(255, 181, 9)"}})})]}),(0,I.jsx)("div",{className:"d-flex fw-medium justify-content-between",children:(0,I.jsx)("div",{children:r||""})})]})}return(0,I.jsx)("div",{children:"Brak danych"})},L=function(n){var e,r=(0,h.Z)(),o=r.yearFromURL,l=r.monthFromURL,d=(0,t.v9)((function(n){return n.monthsPanel})).month,c=(0,x.ur)(),u=(0,a.Z)(c,2),m=u[0],v=u[1],f=(0,H.Z)(v,(0,I.jsx)(Z.GnT,{className:"text-danger"})).btnContent,p=function(){var e=(0,b.Z)((0,g.Z)().mark((function e(r,t){return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N().fire((0,k.p)("Chcesz usuni\u0105\u0107 dzie\u0144")).then(function(){var e=(0,b.Z)((0,g.Z)().mark((function e(i){var a,s,c;return(0,g.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.isConfirmed){e.next=4;break}return c=null===d||void 0===d||null===(a=d.columns[r])||void 0===a||null===(s=a.days)||void 0===s?void 0:s.filter((function(n){return(null===n||void 0===n?void 0:n.id)!==t})),e.next=4,m({year:o,month:l,colIdx:n.columnIdx,daysBody:c||[]});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return(0,I.jsx)(s._l,{draggableId:n.day&&(null===n||void 0===n||null===(e=n.day)||void 0===e?void 0:e.id),index:n.dayIdx,isDragDisabled:!1,children:function(e,r){var t,o;return(0,I.jsx)("div",(0,i.Z)((0,i.Z)((0,i.Z)({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef,className:"mb-2",children:(0,I.jsxs)("div",{className:"border rounded-1 mb-2 px-1 py-2 py-sm-1 ".concat(r.isDragging?"border-dark":"border-secondary-subtle"),style:{backgroundColor:null===(t=n.day)||void 0===t?void 0:t.userColor,opacity:r.isDragging?.8:1},children:[(0,I.jsx)(S,{day:n.day}),(0,I.jsxs)(y.Z,{onClick:function(){return p(n.columnIdx,n.day.id)},className:"d-flex justify-content-between  align-items-center w-100 p-0 bg-transparent border-0",disabled:v.isLoading,children:[(0,I.jsxs)("div",{className:"d-flex align-items-center fs-7",children:[null===(o=n.day)||void 0===o?void 0:o.hours," ",(0,I.jsx)(j.TCC,{className:"  ms-1"})]}),(0,I.jsx)("div",{className:"d-flex align-items-center",children:f})]})]})}))}})},P=function(n){return(0,I.jsx)(p.Z,{className:"p-0",children:(0,I.jsx)(s.bK,{droppableId:n.column.id,children:function(e,r){return(0,I.jsxs)("div",(0,i.Z)((0,i.Z)({},e.droppableProps),{},{ref:e.innerRef,className:"p-1 h-100 ".concat(r.isDraggingOver?"bg-dark-subtle":"bg-primary"),children:[Array.isArray(n.column.days)?n.column.days.map((function(e,r){return(0,I.jsx)(L,{day:e,columnIdx:n.columnIdx,dayIdx:r},crypto.randomUUID())})):[],e.placeholder]}))}})})},F=function(n){var e,r,o,i=(0,t.v9)((function(n){return n.monthsPanel})).month;return(0,I.jsx)(I.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===i||void 0===i||null===(e=i.calc)||void 0===e?void 0:e.submittedHours},{headerText:"Przyznane:",counter:null===i||void 0===i||null===(r=i.calc)||void 0===r?void 0:r.acceptedHours},{headerText:"Odrzucone:",counter:null===i||void 0===i||null===(o=i.calc)||void 0===o?void 0:o.rejectedHours}].map((function(e){var r=e.headerText,t=e.counter;return(0,I.jsxs)(p.Z,{className:"bg-primary text-dark-emphasis fw-medium p-1 ".concat(0===n.thumbPosition?"border-bottom border-2 border-primary":" border-bottom border-2 border-white"),style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[r," ","",t]},r)}))})},B=function(){var n=(0,l.useRef)(null),e=(0,l.useState)(0),r=(0,a.Z)(e,2),t=r[0],o=r[1];return{scrollableRef:n,thumbPosition:t,handleScroll:function(){var e=n.current;if(e){var r=e.scrollTop,t=e.scrollHeight,i=e.clientHeight;o(r/(t-i)*100)}}}},R=function(){var n=(0,h.Z)(),e=n.yearFromURL,r=n.monthFromURL,o=(0,x.CB)(),u=(0,a.Z)(o,1)[0],p=f(),g=p.submittedHoursSum,b=p.acceptedHoursSum,y=p.rejectedHoursSum,j=B(),Z=j.scrollableRef,w=j.thumbPosition,N=j.handleScroll,H=(0,t.v9)((function(n){return n.monthsPanel})).month,k=v(null===H||void 0===H?void 0:H.columns),z=(0,l.useState)([]),C=(0,a.Z)(z,2),S=C[0],L=C[1];(0,l.useEffect)((function(){L(k)}),[H]),(0,l.useEffect)((function(){var n,t;S.length>0&&u({year:e,month:r,monthBody:(0,i.Z)((0,i.Z)({},H),{},{columns:S,calc:(0,i.Z)((0,i.Z)({},null===H||void 0===H?void 0:H.calc),{},{currentHours:(null!==(n=null===H||void 0===H||null===(t=H.calc)||void 0===t?void 0:t.allHours)&&void 0!==n?n:0)-g-b-y+y,submittedHours:g,acceptedHours:b,rejectedHours:y})})})}),[S]);var R="col-sm-8 col-md-9 col-xl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1";return(0,I.jsx)(d.Z,{fluid:!0,ref:Z,onScroll:N,className:" mb-1 overflow-y-scroll",children:(0,I.jsxs)("div",{children:[(0,I.jsx)(c.Z,{className:"".concat(R," sticky-top  "),children:(0,I.jsx)(F,{thumbPosition:w})}),(0,I.jsx)(c.Z,{className:R,style:{height:"fit-content"},children:(0,I.jsx)(s.Z5,{onDragEnd:function(n){!function(n,e,r){var t=n.source,o=n.destination;if(o&&(t.draggableId!==o.droppableId||t.index===o.index))if(t.droppableId!==o.droppableId){var l=null===e||void 0===e?void 0:e.findIndex((function(n){return n.id===t.droppableId})),s=null===e||void 0===e?void 0:e.findIndex((function(n){return n.id===o.droppableId})),d=e&&(0,m.Z)(e[l].days),c=t.droppableId!==o.dropableId?(0,m.Z)(e[s].days):d,u=d.splice(t.index,1),v=(0,a.Z)(u,1)[0];c.splice(o.index,0,v);var f=(0,m.Z)(e);f[l]=(0,i.Z)((0,i.Z)({},e[l]),{},{days:d}),f[s]=(0,i.Z)((0,i.Z)({},e[s]),{},{days:c}),r(f)}else{var h=o.index,x=e.findIndex((function(n){return n.id===t.droppableId})),p=(0,m.Z)(e[x].days),g=p.splice(t.index,1),b=(0,a.Z)(g,1)[0];p.splice(h,0,b);var y=(0,m.Z)(e);y[x]=(0,i.Z)((0,i.Z)({},e[x]),{},{days:p}),r(y)}}(n,S,L)},children:null===S||void 0===S?void 0:S.map((function(n,e){return(0,I.jsx)(P,{column:n,columnIdx:e},n.id)}))})})]})})},U=r(7858),D=r(3855),T=r(5705),M=function(){var n,e,r=(0,h.Z)(),o=r.yearFromURL,i=r.monthFromURL,l=(0,t.v9)((function(n){return n.monthsPanel})).month,s=(0,x.uZ)(),d=(0,a.Z)(s,2),c=d[0],u=d[1],m=null===l||void 0===l||null===(n=l.calc)||void 0===n?void 0:n.submittedHours,v=null===l||void 0===l||null===(e=l.calc)||void 0===e?void 0:e.acceptedHours,f=(0,T.TA)({initialValues:{allHours:0},onSubmit:function(){var n=(0,b.Z)((0,g.Z)().mark((function n(e){return(0,g.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(m+v>+f.values.allHours)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,c({year:o,month:i,allHours:+e.allHours});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()});return{formik:f,success:u}},E=function(){var n=M(),e=n.formik,r=n.success,o=(0,H.Z)(r,"Zapisz liczb\u0119 godzin").btnContent,i=(0,t.v9)((function(n){return n.monthsPanel})).month,a=null===i||void 0===i?void 0:i.calc.submittedHours,l=null===i||void 0===i?void 0:i.calc.acceptedHours,s=e.values.allHours/3.2,d="linear-gradient(to right, rgba(180,120,255) ".concat(s,"%, rgba(180,180,255) ").concat(s,"%)");return(0,I.jsxs)(D.Z,{onSubmit:e.handleSubmit,className:"p-2 bg-primary rounded-bottom-1",children:[(0,I.jsx)(D.Z.Control,{type:"number",name:"allHours",min:0,max:320,value:e.values.allHours,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:"Liczba",size:"sm",className:"p-0 px-1 mx-auto mb-2 border border-primary",style:{minHeight:0,cursor:"pointer",width:"fit-content"}}),(0,I.jsx)("div",{className:"text-danger d-block mt-0 fs-8 text-center",style:{height:"0.7rem"},children:a+l>+e.values.allHours?"Podaj ilo\u015b\u0107 godzin wi\u0119ksz\u0105 od ".concat(a+l," "):""}),(0,I.jsxs)(D.Z.Group,{className:"mt-2 d-flex align-items-center w-100",children:[(0,I.jsx)("div",{className:"fw-medium",children:"0"}),(0,I.jsx)(D.Z.Range,{name:"allHours",min:0,max:320,value:e.values.allHours,onChange:e.handleChange,onBlur:e.handleBlur,className:"form-range custom-range mx-2 medium",style:{height:10,background:d}}),(0,I.jsx)("div",{className:"fw-medium",children:"320"})]}),(0,I.jsx)(y.Z,{type:"submit",variant:"info",size:"sm",className:"fw-medium d-block mx-auto mt-2 col-7 col-sm-6 col-md-4 col-lg-3 col-xxl-2",disabled:r.isLoading,children:o})]})},A=function(){var n=(0,l.useState)(!1),e=(0,a.Z)(n,2),r=e[0],t=e[1];return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(y.Z,{onClick:function(){return t(!r)},"aria-controls":"example-collapse-text","aria-expanded":r,className:"fw-medium w-100 mt-1 d-flex justify-content-center align-items-center bg-primary border-0 p-1 ".concat(r?"rounded-bottom-0":""),children:["Liczba godzin w miesi\u0105cu",(0,I.jsx)(z.x3N,{className:"fs-2 fw-medium",style:{transform:"".concat(r?"rotate(180deg)":""," "),transitionDuration:"320ms"}})]}),(0,I.jsx)(U.Z,{in:r,children:(0,I.jsx)("div",{className:"bg-white p-0",children:(0,I.jsx)(E,{})})})]})},O=r(7689),G=function(){var n=(0,O.UO)().monthURL;if(n&&/^\d{4}-\d{2}$/.test(n)){var e,r=n&&new Date(n);return{monthURLStringFormat:r&&(null===(e=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}))||void 0===e?void 0:e.format(r))}}return{monthURLStringFormat:""}},Y=function(){var n,e,r,o,i,a=(0,t.v9)((function(n){return n.monthsPanel})).month,l=G().monthURLStringFormat;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{className:"text-capitalize fw-medium mt-2 text-center d-md-none",children:l}),(0,I.jsxs)("div",{className:" d-flex justify-content-center my-2 fw-medium position-relative",children:[(0,I.jsx)("div",{className:"text-capitalize fw-medium d-none d-md-block  position-absolute end-0",children:l}),(0,I.jsx)("div",{className:"col-3 text-end",children:"Wszystkie"}),(0,I.jsxs)("div",{className:"mx-2",children:[null===a||void 0===a||null===(n=a.calc)||void 0===n?void 0:n.allHours," -"," ",(0,I.jsx)("span",{className:"".concat((null===a||void 0===a||null===(e=a.calc)||void 0===e?void 0:e.currentHours)<=0?"text-danger":""),children:null===a||void 0===a||null===(r=a.calc)||void 0===r?void 0:r.currentHours})]}),(0,I.jsx)("div",{className:"col-3 ".concat((null===a||void 0===a||null===(o=a.calc)||void 0===o?void 0:o.currentHours)<=0?"text-danger":""),children:(null===a||void 0===a||null===(i=a.calc)||void 0===i?void 0:i.currentHours)<0?"Brak":"Dost\u0119pne"})]})]})},$=function(){return(0,I.jsx)("header",{className:"me-3",children:(0,I.jsx)(d.Z,{fluid:!0,children:(0,I.jsxs)(c.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 ms-sm-auto mx-xl-auto px-1 ",children:[(0,I.jsx)(A,{}),(0,I.jsx)(Y,{})]})})})},K=r(4849),V=function(){var n,e=(0,t.v9)((function(n){return n.infoMonths})).infoMonths,r=(0,t.v9)((function(n){return n.monthsPanel})),i=r.month,a=r.error;if(r.isLoading)n=(0,I.jsx)(K.Z,{animation:"border",variant:"secondary",children:(0,I.jsx)("span",{className:"visually-hidden",children:"Loading..."})});else if(a){if("status"in a){var l="status"in a&&a.status;n=(0,I.jsx)("h3",{className:"text-danger mx-auto ",children:(0,I.jsxs)(I.Fragment,{children:[" B\u0142\u0105d: ",l," "]})})}}else n=e&&0!==(null===e||void 0===e?void 0:e.length)?i&&""!==(null===i||void 0===i?void 0:i.id)?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)($,{}),(0,I.jsx)(R,{})]}):(0,I.jsxs)("h3",{className:"text-warning",children:["Brak danych z miesi\u0105ca ",o.xk,". Zapisz miesi\u0105c za pomoc\u0105 formularza"]}):(0,I.jsx)("h5",{className:"text-warning",children:"Brak miesi\u0119cy zapisanych w bazie danych. Zapisz miesi\u0105c za pomoc\u0105 formularza"});return{panelContent:n}},W=function(){var n=(0,t.v9)((function(n){return n.infoMonths})).infoMonths,e=(0,t.v9)((function(n){return n.monthsPanel})),r=e.month,o=e.error,i=e.isLoading,a=V().panelContent,l="d-flex flex-column bg-primary-subtle";return i&&!r?l="d-flex align-items-center justify-content-center":!o&&r&&n&&0!==(null===n||void 0===n?void 0:n.length)||(l="d-flex justify-content-end align-items-center p-1 pe-sm-5 col-sm-7 col-md-8 ms-auto mx-xxl-auto"),(0,I.jsx)("main",{className:l,style:{height:"100vh"},children:a})}},2767:function(n,e,r){r.d(e,{Z:function(){return a},p:function(){return i}});var t=r(1830),o=r.n(t),i=function(n){return{title:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}},a=function(n){o().fire({text:"B\u0142\u0105d ".concat(n),confirmButtonColor:"rgb(31, 180, 255)"})}}}]);
//# sourceMappingURL=51.0cf3c277.chunk.js.map