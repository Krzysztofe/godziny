"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[869],{8869:function(e,n,a){a.r(n),a.d(n,{default:function(){return D}});var r=a(9439),u=a(2791),d=a(7371),s=a(5048),t=a(1413),o=a(4165),l=a(5861),i=a(6355),c=a(184),m=function(e){return(0,c.jsxs)("div",{children:[(0,c.jsxs)("small",{children:["Imi\u0119:",e.day.userName]}),(0,c.jsx)("small",{children:e.day.date}),(0,c.jsxs)("small",{children:["Godz.: ",e.day.hours]})]})},h=a(3433),p=a(322),v=a(411),b=function(){var e,n,a,d,o,l,i,c=(0,s.I0)(),m=(0,p.P2)(void 0),b=m.data,f=m.error,y=(0,p.l4)(),x=(0,r.Z)(y,2),j=x[0],H=x[1],g=(0,p.X)(),Z=(0,r.Z)(g,1)[0],C=b&&Object.keys(b).join(),k=b?Object.values(b).flat():[],w=b&&k.length>0?null===(e=k[0])||void 0===e?void 0:e.allHours:"",z=b&&k.length>0?null===(n=k[0])||void 0===n?void 0:n.currentHours:"",I=b&&k.length>0?null===(a=k[0])||void 0===a?void 0:a.submitedHours:"",S=b&&k.length>0?null===(d=k[0])||void 0===d?void 0:d.acceptedHours:"",D=b&&k.length>0?null===(o=k[0])||void 0===o?void 0:o.rejectedHpurs:"",P=b&&k.length>0?null===(l=k[0])||void 0===l?void 0:l.columns:[],A=null===(i=P)||void 0===i?void 0:i.map((function(e){return e.hasOwnProperty("days")?e:(0,t.Z)((0,t.Z)({},e),{},{days:[]})})),B=b?(0,h.Z)(A):[],O=b?(0,h.Z)(A):[],N=b&&k.length>0?A[0].days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):[],F=b&&k.length>0?A[1].days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):[],L=b&&k.length>0?A[2].days.reduce((function(e,n){return e+(null===n||void 0===n?void 0:n.hours)}),0):[];return(0,u.useEffect)((function(){c((0,v.w8)(H.isLoading))}),[H.isLoading,c]),{databaseAllHours:w,dataCurrentHours:z,databaseAccepteddHours:S,databaseRejectedHours:D,databaseAllData:k,acceptedHoursSum:F,rejectedHoursSum:L,dataBaseSubmitedHours:I,databaseColumnsId:C,updatedColumnsWithAddedDays:B,dataBaseColumnsWithoutDays:P,newColumnsFromDatabase:O,databaseColumns:A,submitedHoursSum:N,data:b,error:f,success:H,updateColumns:Z,addDays:j}},f=function(e){(0,s.v9)((function(e){return e.hoursPanel})).numberOfDays;var n,a=b(),r=a.databaseColumnsId,u=a.newColumnsFromDatabase,h=a.submitedHoursSum,p=a.databaseAllHours,v=a.acceptedHoursSum,f=a.rejectedHoursSum,y=a.updateColumns,x=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(n){var a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.map((function(e){return e&&e.days?(0,t.Z)((0,t.Z)({},e),{},{days:e.days.filter((function(e){return e.id!==n}))}):e})),e.next=3,y({id:r,columns:{allHours:p,currentHours:p-h-v-f+f,submitedHours:h,acceptedHours:v,rejectedHpurs:f,columns:a}});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,c.jsx)("div",{style:{border:"1px solid black"},children:(0,c.jsx)(d._l,{draggableId:e.day&&(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.id.toString()),index:e.index,children:function(n){return(0,c.jsxs)("div",(0,t.Z)((0,t.Z)((0,t.Z)({},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:[(0,c.jsx)("strong",{children:e.day.content}),(0,c.jsx)(m,{day:e.day}),(0,c.jsx)("button",{onClick:function(){return x(e.day.id)},children:(0,c.jsx)(i.AMf,{})})]}))}})})},y=function(e){var n=b();n.databaseColumnsId,n.databaseAllHours,n.dataCurrentHours,n.dataBaseSubmitedHours,n.databaseColumns,n.submitedHoursSum,n.data,n.updateColumns;return(0,c.jsx)("div",{children:(0,c.jsx)(d.bK,{droppableId:e.column.id,children:function(n,a){var r,u;return(0,c.jsxs)("div",(0,t.Z)((0,t.Z)({},n.droppableProps),{},{ref:n.innerRef,style:{border:"1px solid black",width:"30vw",minHeight:"100vh",height:"fit-content"},children:[e.column.days&&e.column.days.length>0&&(null===(r=e.column)||void 0===r||null===(u=r.days)||void 0===u?void 0:u.map((function(e,n){return(0,c.jsx)(f,{day:e,index:n},crypto.randomUUID())}))),n.placeholder]}))}})})},x=function(e){return(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:e.name,children:e.label}),(0,c.jsx)("input",{id:e.name,type:e.type,name:e.name,value:e.value,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:e.placeholder,style:{width:50}})]})},j=a(3728),H=function(){var e=(0,s.I0)(),n=(0,s.v9)((function(e){return e.hoursPanel})).numberOfDays,a=(0,p.iq)(),u=(0,r.Z)(a,2),d=u[0],t=(u[1],b()),i=t.databaseColumnsId,m=t.databaseAllHours,h=t.dataBaseSubmitedHours,f=t.submitedHoursSum,y=t.databaseAccepteddHours,H=t.databaseRejectedHours,g=t.updatedColumnsWithAddedDays,Z=(t.databaseColumns,t.rejectedHoursSum),C=t.acceptedHoursSum,k=t.data,w=t.dataCurrentHours,z=t.updateColumns,I=k&&Object.keys(k).join(),S=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(I);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z({id:i,columns:{allHours:+n,currentHours:+n-f-C-Z+Z,submitedHours:h,acceptedHours:y,rejectedHpurs:H,columns:g}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)("header",{children:[(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)(x,{type:"number",name:"numberOfDays",value:n,label:"Podaj liczb\u0119 godzin w miesi\u0105cu ",placeholder:"",handleChange:function(n){var a=n.target.value;e((0,v.Cp)(a))}}),(0,c.jsxs)("button",{onClick:D,children:[" ",(0,c.jsx)(j.pl2,{})]})]}),(0,c.jsx)("button",{onClick:S,children:" usu\u0144 wszystko"}),(0,c.jsxs)("p",{children:["Liczba godzin w miesi\u0105cu: ",m," "]}),(0,c.jsxs)("p",{children:["Liczba godzin go wykorzystania: ",w," "]})]})},g=function(e){return(0,c.jsxs)("div",{className:e.containerClass,children:[(0,c.jsx)("input",{type:"radio",name:e.name,value:e.value,checked:e.checked,onChange:e.handleChange,className:e.inuptClass,id:e.value}),(0,c.jsx)("label",{htmlFor:e.value,className:e.labelClass,children:(0,c.jsxs)("small",{children:[" ",e.label?e.label:e.value]})})]})},Z=a(5705),C={id:crypto.randomUUID(),date:"",hours:"",userName:"",place:""},k={allHours:0,currentHours:0,submitedHours:0,acceptedHours:0,rejectedHours:0,columns:[{id:"miesiac",columnName:"Miesi\u0105c",days:[]},{id:"oczekuj\u0105ce",columnName:"Oczekuj\u0105ce"},{id:"zatwierdzone",columnName:"Zatwierdzone"}]},w=a(6727),z=w.Ry({userName:w.Z_().required("Podaj imi\u0119"),date:w.Z_().required("Podaj dat\u0119"),hours:w.Rx().required("Podaj liczb\u0119 godzin").moreThan(0,"Liczba godzin musi by\u0107 wi\u0119ksza od 0"),place:w.Z_().required("Podaj lokalizacj\u0119")}),I=function(){(0,s.v9)((function(e){return e.hoursPanel})).numberOfDays;var e=(0,Z.TA)({initialValues:C,validationSchema:z,onSubmit:function(){var n=(0,l.Z)((0,o.Z)().mark((function n(s){var l;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.setFieldValue("id",crypto.randomUUID()),k.columns[0].days=[s],i[0]=p&&(null===r||void 0===r?void 0:r.length)>0&&(0,t.Z)((0,t.Z)({},null===u||void 0===u?void 0:u[0]),{},{days:[].concat((0,h.Z)(null===u||void 0===u||null===(l=u[0])||void 0===l?void 0:l.days),[s])}),null!==p){n.next=8;break}return n.next=6,y(k);case 6:n.next=10;break;case 8:return n.next=10,f({id:d,columns:{allHours:a,currentHours:a-v,submitedHours:v,acceptedHours:c,rejectedHpurs:m,columns:i}});case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),n=b(e.values),a=n.databaseAllHours,r=(n.dataBaseSubmitedHours,n.dataBaseColumnsWithoutDays),u=n.databaseColumns,d=n.databaseColumnsId,i=n.updatedColumnsWithAddedDays,c=n.acceptedHoursSum,m=n.rejectedHoursSum,p=n.data,v=n.submitedHoursSum,f=(n.success,n.updateColumns),y=n.addDays;return{formik:e}},S=function(){(0,s.I0)();var e=(0,s.v9)((function(e){return e.hoursPanel})).requestState,n=I().formik;return(0,c.jsxs)("form",{onSubmit:n.handleSubmit,style:{marginTop:20},children:[[{type:"text",value:"userName",label:"Imi\u0119"},{type:"date",value:"date",label:"Dzie\u0144"},{type:"number",value:"hours",label:"Godz."}].map((function(e){var a=e.type,r=e.value,u=e.label;return(0,c.jsxs)("div",{children:[(0,c.jsx)(x,{type:a,name:r,value:n.values[r],label:u,placeholder:u,handleChange:n.handleChange,handleBlur:n.handleBlur}),(0,c.jsx)("div",{style:{color:"red"},children:n.touched[r]&&n.errors[r]&&(0,c.jsx)("small",{children:n.errors[r]})})]},r)})),["Wewn\u0105trz","Poza"].map((function(e){return(0,c.jsx)(g,{value:e,name:"place",handleChange:n.handleChange,checked:n.values.place===e},e)})),(0,c.jsx)("div",{style:{color:"red"},children:n.touched.place&&n.errors.place&&(0,c.jsx)("small",{children:n.errors.place})}),(0,c.jsx)(c.Fragment,{children:e.edit.isLoading?"loading":null}),(0,c.jsx)("button",{type:"submit",children:(0,c.jsx)(j.pl2,{})})]})},D=function(){var e=(0,s.v9)((function(e){return e.hoursPanel})).numberOfDays,n=b(),a=n.databaseColumnsId,o=n.databaseAllHours,l=(n.dataCurrentHours,n.databaseAccepteddHours),i=n.databaseRejectedHours,m=n.acceptedHoursSum,p=n.rejectedHoursSum,v=n.dataBaseSubmitedHours,f=n.databaseColumns,x=n.submitedHoursSum,j=n.data,g=n.updateColumns,Z=(0,u.useState)([]),C=(0,r.Z)(Z,2),k=C[0],w=C[1];return(0,u.useEffect)((function(){w(f)}),[j]),(0,u.useEffect)((function(){a&&g({id:a,columns:{allHours:o,currentHours:o-x-m-p+p,submitedHours:x,acceptedHours:m,rejectedHpurs:p,columns:k}})}),[k,e,x,m,p]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(H,{}),(0,c.jsx)(S,{}),(0,c.jsx)("div",{children:(0,c.jsx)("div",{children:(0,c.jsxs)(d.Z5,{onDragEnd:function(e){return function(e,n,a){var u=e.source,d=e.destination;if(d&&(u.draggableId!==d.droppableId||u.index===d.index))if(u.droppableId!==d.droppableId){var s=n.findIndex((function(e){return e.id===u.droppableId})),o=n.findIndex((function(e){return e.id===d.droppableId})),l=(0,h.Z)(n[s].days),i=u.droppableId!==d.dropableId?(0,h.Z)(n[o].days):l,c=l.splice(u.index,1),m=(0,r.Z)(c,1)[0];i.splice(d.index,0,m);var p=(0,h.Z)(n);p[s]=(0,t.Z)((0,t.Z)({},n[s]),{},{days:l}),p[o]=(0,t.Z)((0,t.Z)({},n[o]),{},{days:i}),a(p)}else{var v=d.index,b=n.findIndex((function(e){return e.id===u.droppableId})),f=(0,h.Z)(n[b].days),y=f.splice(u.index,1),x=(0,r.Z)(y,1)[0];f.splice(v,0,x);var j=(0,h.Z)(n);j[b]=(0,t.Z)((0,t.Z)({},n[b]),{},{days:f}),a(j)}}(e,k,w)},children:[(0,c.jsx)("div",{style:{display:"flex"},children:[{header:"Z\u0142o\u017cone",counter:v},{header:"Zakceptowane",counter:l},{header:"Odrzucone",counter:i}].map((function(e){var n=e.header,a=e.counter;return(0,c.jsxs)("h4",{style:{marginLeft:20,width:"30vw"},children:[n," ","",a," godz."]},n)}))}),(0,c.jsx)("div",{style:{display:"flex"},children:k&&k.length>0&&k.map((function(e,n){return(0,c.jsx)(y,{column:e},e.id)}))})]})})})]})}}}]);
//# sourceMappingURL=869.55520c29.chunk.js.map