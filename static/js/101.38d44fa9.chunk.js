"use strict";(self.webpackChunkgodziny=self.webpackChunkgodziny||[]).push([[101],{9662:function(n,e,r){r.d(e,{j0:function(){return l},nt:function(){return c},st:function(){return d},vs:function(){return s},xk:function(){return u}});var t=new Date,o=function(n){var e=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0");return"".concat(e,"-").concat(r,"-").concat(t)},a=new Date(t.getTime()+12096e5),i=new Date(t.getTime()+5184e6),l=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),c=(String(t.getDate()).padStart(2,"0"),o(t),o(a)),d=o(i),u=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(t)},1100:function(n,e,r){var t=r(1830),o=r.n(t),a=r(2791),i=r(4849),l=r(184);e.Z=function(n,e){(0,a.useEffect)((function(){if(n.isError){var e=n.error,r=e&&"status"in e&&e.status&&e.status;o().fire({text:"B\u0142\u0105d: ".concat(r||""),confirmButtonColor:"rgb(31, 180, 255)"})}}),[n.isError]);var r=e;return n.isLoading&&(r=(0,l.jsx)(i.Z,{animation:"border",size:"sm",variant:"secondary",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})})),{btnContent:r}}},9065:function(n,e,r){var t=r(7689);e.Z=function(){var n=(0,t.TH)().pathname.split("/").slice(-1)[0],e=null===n||void 0===n?void 0:n.slice(0,4),r=null===n||void 0===n?void 0:n.slice(-2);return{monthURL:n,yearFromURL:e,monthFromURL:r,isMonthInURL:/^\d{4}-\d{2}$/.test(n)}}},3101:function(n,e,r){r.r(e),r.d(e,{default:function(){return _}});var t=r(2791),o=r(5048),a=r(9065),i=r(9288),l=r(7615),s=r(9662),c=r(1413),d=r(9439),u=r(793),m=r(7022),v=r(9743),f=r(7762),x=r(3433),h=function(n){return Array.isArray(n)?null===n||void 0===n?void 0:n.map((function(n){return null!==n&&void 0!==n&&n.hasOwnProperty("days")?n:(0,c.Z)((0,c.Z)({},n),{},{days:[]})})):[]},p=function(){var n,e=(0,o.v9)((function(n){return n.monthsPanel})).month,r=0,t=0,a=0,i=h(null===e||void 0===e?void 0:e.columns),l=(0,f.Z)(i);try{for(l.s();!(n=l.n()).done;){var s=n.value,c=(s.days||[]).reduce((function(n,e){var r;return n+(null!==(r=null===e||void 0===e?void 0:e.hours)&&void 0!==r?r:0)}),0);switch(s.id){case"submitted":r=c;break;case"accepted":t=c;break;case"rejected":a=c}}}catch(d){l.e(d)}finally{l.f()}return{submittedHoursSum:r,acceptedHoursSum:t,rejectedHoursSum:a}},g=r(2677),b=r(4165),y=r(5861),j=r(3360),Z=r(1830),w=r.n(Z),N=r(1100),H=r(6856),k=r(1578),z=r(184),C=function(n){var e,r;if(null!==n&&void 0!==n&&null!==(e=n.day)&&void 0!==e&&e.date){var t,o,a=new Date(n.day.date);return r=new Intl.DateTimeFormat("pl-PL",{day:"numeric",month:"short"}).format(a),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"d-flex justify-content-between fs-7",children:[(0,z.jsx)("div",{children:null===(t=n.day)||void 0===t?void 0:t.userName}),(0,z.jsx)("div",{children:"Poza"===(null===(o=n.day)||void 0===o?void 0:o.place)?(0,z.jsx)(k.ols,{style:{color:"rgb(80,173,150)"}}):(0,z.jsx)(H.P8U,{style:{color:"rgb(255, 181, 9)"}})})]}),(0,z.jsx)("div",{className:"d-flex fw-medium justify-content-between",children:(0,z.jsx)("div",{children:r||""})})]})}return(0,z.jsx)("div",{children:"Brak danych"})},I=r(3853),L=r(7425),S=r(2767),P=function(n){var e,r=(0,a.Z)(),t=r.yearFromURL,i=r.monthFromURL,s=(0,o.v9)((function(n){return n.monthsPanel})).month,m=(0,l.ur)(),v=(0,d.Z)(m,2),f=v[0],x=v[1],h=(0,N.Z)(x,(0,z.jsx)(L.GnT,{className:"text-danger"})).btnContent,p=function(){var e=(0,y.Z)((0,b.Z)().mark((function e(r,o){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w().fire((0,S.p)("Chcesz usuni\u0105\u0107 dzie\u0144")).then(function(){var e=(0,y.Z)((0,b.Z)().mark((function e(a){var l,c,d;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isConfirmed){e.next=4;break}return d=null===s||void 0===s||null===(l=s.columns[r])||void 0===l||null===(c=l.days)||void 0===c?void 0:c.filter((function(n){return(null===n||void 0===n?void 0:n.id)!==o})),e.next=4,f({year:t,month:i,colIdx:n.columnIdx,daysBody:d||[]});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return(0,z.jsx)(u._l,{draggableId:n.day&&(null===n||void 0===n||null===(e=n.day)||void 0===e?void 0:e.id),index:n.dayIdx,isDragDisabled:!1,children:function(e,r){var t,o;return(0,z.jsx)("div",(0,c.Z)((0,c.Z)((0,c.Z)({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef,className:"mb-2",children:(0,z.jsxs)("div",{className:"border rounded-1 mb-2 px-1 py-2 py-sm-1 ".concat(r.isDragging?"border-secondary":"border-secondary-subtle"),style:{backgroundColor:null===(t=n.day)||void 0===t?void 0:t.userColor,opacity:r.isDragging?.8:1},children:[(0,z.jsx)(C,{day:n.day}),(0,z.jsxs)(j.Z,{onClick:function(){return p(n.columnIdx,n.day.id)},className:"d-flex justify-content-between  align-items-center w-100 p-0 bg-transparent border-0",disabled:x.isLoading,children:[(0,z.jsxs)("div",{className:"d-flex align-items-center fs-7",children:[null===(o=n.day)||void 0===o?void 0:o.hours," ",(0,z.jsx)(I.TCC,{className:"  ms-1"})]}),(0,z.jsx)("div",{className:"d-flex align-items-center",children:h})]})]})}))}})},F=function(n){return(0,z.jsx)(g.Z,{className:"p-0",children:(0,z.jsx)(u.bK,{droppableId:n.column.id,children:function(e,r){return(0,z.jsxs)("div",(0,c.Z)((0,c.Z)({},e.droppableProps),{},{ref:e.innerRef,className:"p-1 h-100 ".concat(r.isDraggingOver?"bg-dark-subtle":"bg-primary"),children:[Array.isArray(n.column.days)?n.column.days.map((function(e,r){return(0,z.jsx)(P,{day:e,columnIdx:n.columnIdx,dayIdx:r},crypto.randomUUID())})):[],e.placeholder]}))}})})},B=function(n){var e,r,t,a=(0,o.v9)((function(n){return n.monthsPanel})).month;return(0,z.jsx)(z.Fragment,{children:[{headerText:"Z\u0142o\u017cone:",counter:null===a||void 0===a||null===(e=a.calc)||void 0===e?void 0:e.submittedHours},{headerText:"Przyznane:",counter:null===a||void 0===a||null===(r=a.calc)||void 0===r?void 0:r.acceptedHours},{headerText:"Odrzucone:",counter:null===a||void 0===a||null===(t=a.calc)||void 0===t?void 0:t.rejectedHours}].map((function(e){var r=e.headerText,t=e.counter;return(0,z.jsxs)(g.Z,{className:"bg-primary text-dark-emphasis fw-medium p-1 ".concat(0===n.thumbPosition?"border-bottom border-2 border-primary":" border-bottom border-2 border-white"),style:{fontSize:"clamp(0.8rem, 3.4vw, 1rem)"},children:[r," ","",t]},r)}))})},R=function(){var n=(0,t.useRef)(null),e=(0,t.useState)(0),r=(0,d.Z)(e,2),o=r[0],a=r[1];return{scrollableRef:n,thumbPosition:o,handleScroll:function(){var e=n.current;if(e){var r=e.scrollTop,t=e.scrollHeight,o=e.clientHeight;a(r/(t-o)*100)}}}},U=function(){var n=(0,a.Z)(),e=n.yearFromURL,r=n.monthFromURL,i=(0,l.CB)(),s=(0,d.Z)(i,1)[0],f=p(),g=f.submittedHoursSum,b=f.acceptedHoursSum,y=f.rejectedHoursSum,j=R(),Z=j.scrollableRef,w=j.thumbPosition,N=j.handleScroll,H=(0,o.v9)((function(n){return n.monthsPanel})).month,k=h(null===H||void 0===H?void 0:H.columns),C=(0,t.useState)([]),I=(0,d.Z)(C,2),L=I[0],S=I[1];(0,t.useEffect)((function(){S(k)}),[H]),(0,t.useEffect)((function(){var n,t;L.length>0&&s({year:e,month:r,monthBody:(0,c.Z)((0,c.Z)({},H),{},{columns:L,calc:(0,c.Z)((0,c.Z)({},null===H||void 0===H?void 0:H.calc),{},{currentHours:(null!==(n=null===H||void 0===H||null===(t=H.calc)||void 0===t?void 0:t.allHours)&&void 0!==n?n:0)-g-b-y+y,submittedHours:g,acceptedHours:b,rejectedHours:y})})})}),[L]);return(0,z.jsx)(m.Z,{fluid:!0,ref:Z,onScroll:N,className:" mb-1 overflow-y-scroll",children:(0,z.jsxs)("div",{children:[(0,z.jsx)(v.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1 sticky-top",children:(0,z.jsx)(B,{thumbPosition:w})}),(0,z.jsx)(v.Z,{className:"col-sm-8 col-md-9 col-xl-8 d-flex column-gap-1 ms-sm-auto mx-xl-auto  px-1",style:{height:"fit-content"},children:(0,z.jsx)(u.Z5,{onDragEnd:function(n){!function(n,e,r){var t=n.source,o=n.destination;if(o&&(t.draggableId!==o.droppableId||t.index===o.index))if(t.droppableId!==o.droppableId){var a=null===e||void 0===e?void 0:e.findIndex((function(n){return n.id===t.droppableId})),i=null===e||void 0===e?void 0:e.findIndex((function(n){return n.id===o.droppableId})),l=e&&(0,x.Z)(e[a].days),s=t.droppableId!==o.dropableId?(0,x.Z)(e[i].days):l,u=l.splice(t.index,1),m=(0,d.Z)(u,1)[0];s.splice(o.index,0,m);var v=(0,x.Z)(e);v[a]=(0,c.Z)((0,c.Z)({},e[a]),{},{days:l}),v[i]=(0,c.Z)((0,c.Z)({},e[i]),{},{days:s}),r(v)}else{var f=o.index,h=e.findIndex((function(n){return n.id===t.droppableId})),p=(0,x.Z)(e[h].days),g=p.splice(t.index,1),b=(0,d.Z)(g,1)[0];p.splice(f,0,b);var y=(0,x.Z)(e);y[h]=(0,c.Z)((0,c.Z)({},e[h]),{},{days:p}),r(y)}}(n,L,S)},children:null===L||void 0===L?void 0:L.map((function(n,e){return(0,z.jsx)(F,{column:n,columnIdx:e},n.id)}))})})]})})},D=r(7858),T=r(3855),E=r(5705),M=function(){var n,e,r=(0,a.Z)(),t=r.yearFromURL,i=r.monthFromURL,s=(0,o.v9)((function(n){return n.monthsPanel})).month,c=(0,l.uZ)(),u=(0,d.Z)(c,2),m=u[0],v=u[1],f=null===s||void 0===s||null===(n=s.calc)||void 0===n?void 0:n.submittedHours,x=null===s||void 0===s||null===(e=s.calc)||void 0===e?void 0:e.acceptedHours,h=(0,E.TA)({initialValues:{allHours:0},onSubmit:function(){var n=(0,y.Z)((0,b.Z)().mark((function n(e){return(0,b.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(f+x>+h.values.allHours)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,m({year:t,month:i,allHours:+e.allHours});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()});return{formik:h,success:v}},A=function(){var n=M(),e=n.formik,r=n.success,t=(0,N.Z)(r,"Zapisz liczb\u0119 godzin").btnContent,a=(0,o.v9)((function(n){return n.monthsPanel})).month,i=null===a||void 0===a?void 0:a.calc.submittedHours,l=null===a||void 0===a?void 0:a.calc.acceptedHours,s=e.values.allHours/3.2,c="linear-gradient(to right, rgba(180,120,255) ".concat(s,"%, rgba(180,180,255) ").concat(s,"%)");return(0,z.jsxs)(T.Z,{onSubmit:e.handleSubmit,className:"p-2 bg-primary rounded-bottom-1",children:[(0,z.jsx)(T.Z.Control,{type:"number",name:"allHours",min:0,max:320,value:e.values.allHours,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:"Liczba",size:"sm",className:"p-0 px-1 mx-auto mb-2 border border-primary",style:{minHeight:0,cursor:"pointer",width:"fit-content"}}),(0,z.jsx)("div",{className:"text-danger d-block mt-0 fs-8 text-center",style:{height:"0.7rem"},children:i+l>+e.values.allHours?"Podaj ilo\u015b\u0107 godzin wi\u0119ksz\u0105 od ".concat(i+l," "):""}),(0,z.jsxs)(T.Z.Group,{className:"mt-2 d-flex align-items-center w-100",children:[(0,z.jsx)("div",{className:"fw-medium",children:"0"}),(0,z.jsx)(T.Z.Range,{name:"allHours",min:0,max:320,value:e.values.allHours,onChange:e.handleChange,onBlur:e.handleBlur,className:"form-range custom-range mx-2 medium",style:{height:10,background:c}}),(0,z.jsx)("div",{className:"fw-medium",children:"320"})]}),(0,z.jsx)(j.Z,{type:"submit",variant:"info",size:"sm",className:"fw-medium d-block mx-auto mt-2 col-7 col-sm-6 col-md-4 col-lg-3 col-xxl-2",disabled:r.isLoading,children:t})]})},O=function(){var n=(0,t.useState)(!1),e=(0,d.Z)(n,2),r=e[0],o=e[1];return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(j.Z,{onClick:function(){return o(!r)},"aria-controls":"example-collapse-text","aria-expanded":r,className:"fw-medium w-100 mt-1 d-flex justify-content-center align-items-center bg-primary border-0 p-1 ".concat(r?"rounded-bottom-0":""),children:["Liczba godzin w miesi\u0105cu",(0,z.jsx)(H.x3N,{className:"fs-2 fw-medium",style:{transform:"".concat(r?"rotate(180deg)":""," "),transitionDuration:"320ms"}})]}),(0,z.jsx)(D.Z,{in:r,children:(0,z.jsx)("div",{className:"bg-white p-0",children:(0,z.jsx)(A,{})})})]})},G=r(7689),Y=function(){var n=(0,G.UO)().monthURL,e=n&&new Date(n);return{monthURLStringFormat:e&&new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"long",timeZone:"UTC"}).format(e)}},K=function(){var n,e,r,t,a,i=(0,o.v9)((function(n){return n.monthsPanel})).month,l=Y().monthURLStringFormat;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"text-capitalize fw-medium mt-2 text-center d-md-none",children:l}),(0,z.jsxs)("div",{className:" d-flex justify-content-center my-2 fw-medium position-relative",children:[(0,z.jsx)("div",{className:"text-capitalize fw-medium d-none d-md-block  position-absolute end-0",children:l}),(0,z.jsx)("div",{className:"col-3 text-end",children:"Wszystkie"}),(0,z.jsxs)("div",{className:"mx-2",children:[null===i||void 0===i||null===(n=i.calc)||void 0===n?void 0:n.allHours," -"," ",(0,z.jsx)("span",{className:"".concat((null===i||void 0===i||null===(e=i.calc)||void 0===e?void 0:e.currentHours)<0?"text-danger":""),children:null===i||void 0===i||null===(r=i.calc)||void 0===r?void 0:r.currentHours})]}),(0,z.jsx)("div",{className:"col-3 ".concat((null===i||void 0===i||null===(t=i.calc)||void 0===t?void 0:t.currentHours)<0?"text-danger":""),children:(null===i||void 0===i||null===(a=i.calc)||void 0===a?void 0:a.currentHours)<0?"Brak":"Dost\u0119pne"})]})]})},V=function(){return(0,z.jsx)("header",{className:"me-3",children:(0,z.jsx)(m.Z,{fluid:!0,children:(0,z.jsxs)(v.Z,{className:"col-sm-8 col-md-9 col-xl-8 col-xxl-8 ms-sm-auto mx-xl-auto px-1 ",children:[(0,z.jsx)(O,{}),(0,z.jsx)(K,{})]})})})},W=r(4849),$=function(){var n=(0,o.v9)((function(n){return n.infoMonths})).infoMonths,e=(0,o.v9)((function(n){return n.monthsPanel})),r=e.month,t=e.error,a=e.isLoading,i=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(V,{}),(0,z.jsx)(U,{})]});if(a)i=(0,z.jsx)(W.Z,{animation:"border",variant:"secondary",children:(0,z.jsx)("span",{className:"visually-hidden",children:"Loading..."})});else if(t){if("status"in t){var l="status"in t&&t.status;i=(0,z.jsx)("h3",{className:"text-danger col-5",children:(0,z.jsxs)(z.Fragment,{children:[" B\u0142\u0105d: ",l," "]})})}}else n&&0!==(null===n||void 0===n?void 0:n.length)?null!==r&&void 0!==r&&r.id||(i=(0,z.jsxs)("h3",{className:"text-warning text-center col-5",children:["Brak danych z miesi\u0105ca ",s.xk,". Zapisz miesi\u0105c za pomoc\u0105 formularza"]})):i=(0,z.jsx)("h5",{className:"text-warning text-center col-5",children:"Brak miesi\u0119cy zapisanych w bazie danych. Zapisz miesi\u0105c za pomoc\u0105 formularza"});return{panelContent:i}},_=function(){var n=(0,o.I0)(),e=(0,a.Z)(),r=e.yearFromURL,s=e.monthFromURL,c=(0,l.a6)({year:r,month:s}),d=c.data,u=c.error,m=c.isLoading;(0,t.useEffect)((function(){n((0,i.jw)(d)),n((0,i.MP)(u)),n((0,i.ed)(m))}),[d,u,m,n]);var v=$().panelContent,f="d-flex flex-column bg-primary-subtle";return(m||u||!d)&&(f="d-flex justify-content-center align-items-center"),(0,z.jsx)("main",{className:f,style:{height:"100vh"},children:v})}},2767:function(n,e,r){r.d(e,{Z:function(){return i},p:function(){return a}});var t=r(1830),o=r.n(t),a=function(n){return{title:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Tak",cancelButtonText:"Nie"}},i=function(n){o().fire({text:"B\u0142\u0105d ".concat(n),confirmButtonColor:"rgb(31, 180, 255)"})}}}]);
//# sourceMappingURL=101.38d44fa9.chunk.js.map